// evmone: Fast Ethereum Virtual Machine implementation
// Copyright 2023 The evmone Authors.
// SPDX-License-Identifier: Apache-2.0

#include <gmock/gmock.h>
#include <intx/intx.hpp>
#include <test/statetest/statetest.hpp>
#include <evmc/hex.hpp>

using namespace evmone;
using namespace intx;
using namespace testing;
using namespace evmc;

TEST(statetest_loader, tx_eip1559)
{
    constexpr std::string_view input = R"({
        "input": "b0b1",
        "gas": "0x9091",
        "value": "0xe0e1",
        "sender": "a0a1",
        "to": "c0c1",
        "maxFeePerGas": "0x7071",
        "maxPriorityFeePerGas": "0x6061",
        "accessList": [],
        "nonce": "0",
        "publicKey": "0xb543b479d32596ff68142e1b094d6c5bb163637cdb1a7823545bbb247216c3eb88b3cc84994aecd8b2efca728e5b7d230aeab46f170fd728959fe12adaa224db67821612405e10f3ffd7ca17cbe6d334603df756982676098c4b312043c28e9ac4333c6adca787b626df488a6073e625ec15b43ad996540ff4acbc0399f86c3b71db66c34b418f88649a15998cdf66d2df70ec147b7806fa2af6e474a17fdf4fbfb9770fe667639cce85afe43af7921a25c47b4a90f681e2014444d2d1dd72e8425a3212dea2e32027c12d04f694fd760c3807296604d8e75bfc391227a07d8e94268bb05fdc6d60c2ec5295148fa440fa519199e8d71cef5d6273f41c6b97b45a78eea4b95ec1be66f68333a8aafb9a54afae1d2df212f0242a91fa3f7a56e41cceb5371e0e54e54e91e3a845ed4002b37d1b7fc9a38fa519403d5777ebeff4e670db5b5756d4528891bbd1633ea971e5abd94fd3952aa16a93ccac79ed0b7a3bfe61b9c8556540665d3f7671bab015a9558b30c16c664637e8f597f6f5f12438bddd3a6a8425c1d43e4f6284f06fc1fecd08e409d43e7f27bd7e80ced2d20a51de41e3d16c772b417a76e6a70bff7e7d77befa243a669ce8ff11c925f1f892cb77af590861983bfa5270dd0960cad197fb903b71cae817352bf9345cf6f1d764a66c5921f8fac3c85c03b32920ea152664d0a6cdc6ce1f972341bddcc6c5f42cee426c40957e2333cedff343f2be9a351b89cd7dc561eec8ae89f7e470d5248660c419dab6958bec40c7c660ec10ee2cd6b45f14e66bcc171d53b973191bed67d3a6dccd74658a483afb735a86a0c554aeb9ada238075c1804ac11930c268930d8bd9e43c2e2d961c0133a3e74661761b3020f772a2abdaa897679916c3b03c151224245e310d9be7f8d1720ab98edcfee9b9940e1524a3a31a17cf5a519ca0e798be339780484180d612286f74b6c050fd4b1afc7021fdf631acc8ba06fd203f149af1c3fe975b0a8118e23c888fc21a60b91acbc420cde6485291cc7d28a0cfcb24efd3458cef7a676dfa10f3d83decb681d48887d7bb49da95fa4f37eca3ffba930421924a20dcc5c3e18a4bac0ffa63d33d62bb2a35a42bab8daf98fab963d1973de9eca38a40e13afc860c06ab8f5e1d20204167871ceb7205530e76720613b009465bb96d6d0554d7f5cbb278fa43e27435a4900464527d42b5960554cc1de5c65cce01532e389fc8eef02f82310ae0965b005f408ce5869b12760660f3da490d9df0477f9afddc03385860014fb921e623ff675dfd9000ad648ccd07eaaeff6ad640c71ad1e23b4bebb16c4aad8a59c4601fc92b70e7269cc9526226c77ed430827efb0fc8ab78e6f16005a138635ad39d365571195a5429a8998a90309ce489186c2cb902ef7a6982bc4b2693abb911d75643877361189cb0d72c08b5eb8c820589cf4e5fe4d46c8721d6a021be1765b2d6c49718a87a03e675d108af6fd9b48f5abca6d7409b1fee92cb5145b9b76d669fce00f9ed6a1047f722b5b4ebfc80f3297ea615bd64ecf51b8777b3a67676d7c48e842bf80f7b84fe3932e58965aff87506739d8bce9792c86c78d43feb83c75008962cc9f4a2e9a52cb94745096cde33f60ad603646f29e317c0ff78c0a3ea200f665aa7c7a4faf338cead6a8ed91b87762cacfd49108ce5c1ec5719cec1cedfbfab64e2aaeb39eecdfae2a3a68df4ea4789c11d4f14fdb034c45c6edecb250cf61c84636ed220289ca958790acb106327705bef2f5cb4f5dd15ae03ed74ef55fffd24d2d8fdd8ef59d990ccf0a418afd23668108e926489145cd6a3e976094a6815962b0a8d45d4cee03ee53fd57e929248e1b6f077b16b6cd5e3e0e08f94bd87df1c360af983c995c126acc3ce00cb19d2dd673e0568dd014713c54d764b6f200a7efada394a44236b765d76261b07d69b76c6427a4433c4617b1503888d88c360636d8090b6dbd5cd2b8c9d83ed82180a150c663ea84d6cfcbad3d52a8b95854baaca3139c8ba52e4a2f6b5589ec77a6382eb502042687f4787b5daa8c6c48bc1d34dbb98a052e52b92a5d2fb5d3dfa0e590c187d93724d497cda403f574b70b1668e3ee2e86a6875135b4bec11a83d853ccebab523360de8cc0fef2594526a81643cef955d78846a7eb8db22b9b225c631d138c3d30cc95b8dea54385d6074a90db216ad07687b1d2353a9e657e61e09a5820cbc1aac4dc03725c60fd48f27b6f0f5420811b30e3bf3b194187cf65ace99d07f54e5b06b43554d63095ec6c3ba13bdcc115155614c7d27ba1940841435111d353251c90bc008e7138e0101b576a2bd60b5e14b4a9cfb51c06dc28681a6afd62c791309e618bfaebebdd59673cf0f5b5aa683816425c0bd1a36bf6f2e74e56db16d8bacd07c851ff6f83f59f38e7aad7479710327487bf176c097ba075191dc67fbdc058ef145a63a5e9f7bdf4904d82ccdb1948790ce99d0144aa12994dc4caee920a2dd5c2bb2c6159374f2ad102d640b7ee7fd94f87807b0eb17d5a676f30b6891aac832b3a541c803711b443dbee27c781471223e5a537312b2e789759bd914c0449d47e42f2690b50762ac4881344e55963a5c77234ef825889de8aadb45d8e9be4977f5868eda16a7744c4c7ade92c804157149005d2b6fb74f730d1695831b7a18c89e87bc2068eb943fa5612e6d130ada284c160d29d2a17ae60df3e8edda822f5c9cda318b51dd65d398d06e58a43ed2b8ff74aa9ab9aaf9c3e8765ba0a374dec4408baabe153a22971407de08ef7d10d20ae6318555f78af959d9a79e0ccf07f250e0f1ff0d900811f1f8fa695c8daace0bb2dbb44f4499e4be4afa47a0c3cdf89aca059a7b4851fd51713c50ba353b7ea9541057270c04c6b9adce2db02f2bade95f34c1b2e0045ac583b6526920031de3ab9bbea36e5ef91a8a012f62ee4803ccd168488d8490467838524f061d40416c4646f81e375937d90eb75d6ef7c36681023191487154e0c25374f8fd3a5d1891fe76c2201d29e6f6bcdd969bebc5512f84e52164fa1694dbce1bd034e5fcaef6ba96ec8945c49099d9dfc61f4d6f8b1ce22f0843ef649b09b67f670d029716855e4aa3f82651ddcce85b765a04eebe30cc8eebf85e69658d5dc19f705c27c989015ecf774b147059c8405c1bae15bd2c7b4a3a7bebed8729daa7f962a75708107e2445f975c3075eecb05439dc4b66b4cd8bf57392bf7be31682ae214049536971ddf7eb8e5b62d359b4c8097333b6ac423ca35dbcc52daedbcb9dc4d8e811e6c281794bfd676e78e675dca6ddfc1da8c05d54d990aea0e7050b75dc57473bc6ca0c6bd9d018a0f3d406816b89e90eb17951034da9f68dfb2736b0c42f4f98ad2301288436dd21c944485e8e084e0408e84e1946e67230730c6af3620f64475dd62fe614fd01a18952d8b396676f747107c467d37b12be91fe164ae083e5ce12f5e8c2a7bccea9f75ff8ea40cc2f8a4fa521fcd92adc7e5b1187ce7e233d7e98c8782b30ebd9ef9c2f15feb6373751accb6eba57b1ead3af4bc5a2b2b4acccaba442fbfbde89ac8ea1e5f9bbb5c122ce22a53371250a58e5d7a735419cc32a8ab047cf097253f8a84dfe64c208b0b0c80e5930cb26ce93f375eb3c1db4bb7",
        "signature": "0x131cea321925fbfd34681919d181826208ee5e27280a0882101b8072cf371aab14330a0fa303e2cbbc5ab5bd5f54e23077563a75f4f261e05ae6a7d55a92e8fe0b8c899d8b5145723c23e3d606f7797099866e0f4075dcd0f68c5a86295a4d1414acf5a14d22392477a96e12b4ac9f554f522381d9a641d888f1f4d0bb18092adbac3578c737233f9c39ff1ee7a23449d6b5f43e30dad56d3ac83a324fef6335faaab40ffaab92c1c9575d28645c2681031ca51141ee13d9dbf79fa0adbcb04b582fc6a41f6e9d13a1c5ebd89430c67e0cebd70905420be18465e6db742b117fb39b29613b7f29bb028535cfdc3e9fd2d498ce3c03947a1c28c1efcba723aad5599f6b9a1800cf47238ebf0c4ba4c0fc525302b16ada42d13511c4d231beca31ac680a8ee2ece5714705451160e3f8a9d2c2b8d1e18fdf2a9b38a0ef4bc1bb476fcce8a06e5d5f3f0f5f1e629b47670b093955fd2750ce3fd9b331b4f009d62fc07f86b18e6ecbdfc742f348836cd7abcdcf48f2c75960d01617007b4ac89ad220eefe9f933acfd1677513c042ba32e4d7bb1a4cd7d453b37e7a36770dac2f0e20a45ba8ca253d6bc87599e9b8c20879d6bbd30e116a219661cabe9e219abbbb6972bf9374817f4bc73528b0ae9831545571f3645dd9b210b5858570951cd32e3d81fe083073352d962d0c6ac212587fc99ad76a7dc15679e236f29cf33c38d7ae6ec364688f53f0a0d93875b6b8f969f5123579ca0311ff521a91f4e3010fc6863adc4c8056f41bd8441f38e6d197acf06ba452ddc2ed17156725a9db5db8aee34144af0f31bcdc8b15af8190351fa68656ff5f6cf0bf45345239fb0097cccca7536b81e08fede797118a5e10e1427f06e95e70a97b426bc2b1326eed13a07877958d2586d42552b41ecf1fcad21f59dc9c4d48837eb6fd0f9f20e3cda3f427f9d371abc99706596680c1bf068c238c361cb85f31c391662f9cbf6404144a07fae246da521d98fe21c039677f87f32357aa727ca8e5811f7a4af0c28eb800e734ec42332092133a77ad5a757f0f73ad8d0df0c07ecaa09dd78349b500c6bff466750107a1f8b9f3c8ff251b7026b1de0fa7a57806f447f5817f670aad99d89fe88e997f4f1c3f4a474bddfc424245a6042f923cad0d8b7a3ebdf005ac3138f7edfeab5b7d6a642f4b41d2e2b0b342bbdcb677d1440313fcd003e3cf6a18be70172f0f6ee0a5545a5dbd1902d0d9cadfb7e74cb4946364a81bf8d8440fb006b3ee0ccfead39209c4db55bcd339ce6b97d9016d30aa82118ba1a169daae06174c9f375fb02c6857925bd112c08307a463c46d94a74c6f61e8adc2eb3cc9fbdd6177ce0fce161aca2c23d424e1a3d8286f524bb73f5c4268dc3b10477758743780eedc9ef0aca5f24f1782dfb771713b8a04100681d8bbda636fcbb4cbb4eb38b84b9d038f5af5815dc0caa4085f0e75f06b4a23fcea2bc9673be28ff4f08f3b8f1da7d9a1b766e7858b7c9d07ac793395e240ec9479c9b6d1be8fdcfa034d596c21cca6a654ab8dbb86f4fa96cbb638ac79fcfb52f1758b2e25fa713e9d00cb1d049e05beb06a5fd7a41546c27f48e0d570361b3583ab0e3a8f45d66d26fb9ae45e1c2f5e21ecc6fdbe1a8887447407e6e846bdcc0c4503bdc4d1251413af44c4211ba2693f7739e608d4fae117298d5b54bdbe49d956854e652ac4fca43e754c5b9f7f6c07c8e591770fe5ec88250ec08a5c2aaed6ab0b547e7420522146a608488120da81f12a6812b6811224d8dcfddc3c2029cfc57f38d6c26b55006ae38332413a30981871123131dc9f59726abdb9ddcabb45cb681f2a9ec768dab64d0e91950b5a4402fb84600dfcea66ff9579a89b2310ab84940c7b4cafafe4b5401fb6b96d33595e3b2fc6d77caa4eb5acdc4e60ee2c825bdf9dd042ddb58ba228f0ffed3164fe5be4bf4c4c278b7d8002fba4a51ee116b16319da4e580bcf930bb354639554ec469066ac4b01d2fca1273c006bd65d9be494638e26e93871f6053cccdbc42450693d41d26baca77f2da4d7dc94f089fedb29da25968dab109a634d010dfe91bb04c7047151485412ff1a84cd7daa44c830b9767dac473b7d0f1da7e62c53c8c5ef41cdabb4b4a55cf0a37e6a8ca522d4f0ca6cec0ca4d154684a9123f4cf2573a013abf04aec343e79458b3510377a10d6a0b89a8f0abb52f1a77013357faa9e3ec2086c2dcc9299e06993590bcf3ee43d4f5a0a56830acb876af929ff56ae63120e7e33d040e4697ed3819d17878badcfef17ce5fad90c17e29448665ca0dcafcc891f696a50402eb9c96c517e5eb7e796b05db330d79e9e74ef8e14d22174607258ed4c704c11ac617b02cc4b628d7911acb7ab67def265a0cfc02a6b5e2b73922fc8be941d31cc192a113f70f803b6467cf0ce3b96c3cd6d652c6d11f98af06a12cd993b80daca08d16bd71b265218b62af36cf1ab5d975a13743f3acee638203cea0d1e54875b396d950036f3209620a487306589f9e4bf5ac88f3926fe93b8465ff50689f26a358d9461544a0c5484750333b75a2b8d471f962b1a7ae288372f06bfcc75b35721d551018b1604234f97a04d9dcc1dfee735857074ce8c2afed249add41226f0fa401bfd6d80b97d13648c62a50240a39bdcc0c5c653701bebee3fc0bee0650f4f27fb0701933b56766c4de3bce8750fd88fadf2bccb6c2e520422431474371e949091b36e89fddc0c63bcd95602f423e91eb7dcd4735ac41b47aa65b2ebdca4f7905c9282efd26ae7abaeccf329833b1135f8ad520c9ec36eb919e3793ee40ee6d393957aee78ed6afde608c43c985608c40a6e6ebc91c5b3ec7788ea17e30ba5752dbc22944e3a63615c42654f88f7f559b8dfc3addc60a94e3f22d023cdf9d67d3e0927e43f7151e335ed488716b34e22c67cb4ce5b2d8da9163d5ed5e582fcb05886ebd01f4f353bfe794bfa4b9f55ea79cc865f67a5d1a2536da33efba5fefcb368ae071ddd4ff58b201011e7a631d272adc15fab9ed46c5b8f5c0aad75f550327f738222713f9a752f754ee1bfa18b671c741d3ec6492a8525aea8428754b51b190cd4d290f8b1d470cf4b75ca541e8efe67ea38166c307958822a48e79c9cb7c83112009f47686d11bdc25bc3d1519e0e452967ccef3cf47669584088849de602afbec9c7d64951d6a4ad92a49d981b67d3a992bf83a9bb021408a2255186d9b7c229a51b505a5f8eb2603fd8822a2de8ca3c583bf9f373614ee905a6ebe2b478d0f07c1b790bc8c1e5db7f81511a12878dd97c242e9dffe8dfd087e17dfbe885132a4399136ee663f4d94a2e58dac1b8abfeaef38d7404802a72c2ddfc36591c27c5b369ef6174fa07e483a35d00101479e350e047f8adfc49e28862ea360dacaa9f52b8b0f5e2816bf80ad62906830f57d59357ffe7326e8f6e2185c026634e67346e801419473de2934f555b2061f9b9b459e71bd704c9156e0193fb12a6b8fd49719b21249ab8953ce04df037da1655c0ac0c3a25fec70c90fd18bf51946c18147f9e6a3287895f4d6183012701ded7de25ee3616b7237d910d42b065bc5e554b51d07f3e98c240e0a6c019c74075996ab23ad217daebd1f5c0bb402f597de5159235bc6589b76b94d7532b86b3d6728386ddffefbae921be8d05074011a75b63640829e68e2d4b70ecbac1637e4a9a77ee9ab8179d35ca0256b357a00dd63c792a1ad5ca259956a1b1a51f7819793b68443e2b28550e33a07d360b214581cbc367a87512d1dd758ce2e9f6196046412c942613b5ef4dce7c7fe07bbdf425eb0afab16192561bab9e67b06f47c461a9f5b3baae0f27ddf3a9812836e9debb961ebdb4cc377edfbc05a610ce8f7ce9f12e3c4abb6ca51b96323b204b48dfa8abeea27785c273a9d700c8f8fca96e1d1a2799fb23a045ffd58ca485bfc9d930ccee781beac3560f45909414806faf0bb8fc6657384c13fcd5e9da7b79834292dfd6418690b03cb6718b7c9637fa918f6a9a19d3dfe3a76d96bb3c0db0fd6751b9a394b55460042036e0b85c1e135a2a9d37dd871afa405e4ae5827c47e657d9694f51bee74768b03ee9e7b8731919e962cfaec19439e5eaa40f92e7094de8ab6c0a91b451b6d0cbefa9e44a471ca1549c78e66a2c622dc07294fa908e0e64e100c3550edb8c31f302f81aa8e154e9f666cfe904145a9c7ecdb3765f60c7ba06360df5639ef684653a5f90bb47510d0357cd5f0de0ed0419477b6af059f01948954b3844627853bb23fb76861fed81a09a03ce4a4c512dd91bba59e72aef3936290979d93222667ac31df7514e5eac1b53efdda607215af47a813af08588d28cd9c2ef93985b47bd6e833ac07de0af0aeeb92ad36af2c05f47d6a31ee75e19b841ffc79ae865edddd97865b7f661aed157922f93903884cc6d489d8f1a6160c31509b9250c481c9d9ed99778e90a38969549c563820a13ebb5dd0184dfc58d28614ce1522bf4e99724e9452f64592ab01424035581780653d5093468c555dfc52ac86e43644e0f3f89d06c7cc0d6566bde0b2fdb896665425e5cc80bd4795247217a08f16fdf9e522ff7868b01598e0b8a41da2221fdb646409eb102107a20d5ea06ea3b3c0139d02480be6e42cc00b2a32ccdd0eeeaea90e1dcbef4bbd7b7100a74486354ce5baa8a230ec7c58e1f9269124057c491c48a02159cf3f37375f8bfaeb4eafd6fa9d8209dbcba61c8d189171c313ac75ed7d69f5b16ee60ee7cfc0f98d76796643d2bf4555db2b3604914e06b2c55dc62607bf622956705762005ceeed11599871f89cc7e2d4d86231bec5d423382e77f9707c41d6062efc56512e6339e34b64152393e8d42391b6311423f8730a85261375e5fcd5cff5f26abb6faaa75e8f8167cc6374f8f3fbe10b688f292fb4cc12c93f678b8f5110cd8baaae7e8ba05a11f8b469adb853f7d20fe2d6b8f0980e83ec83ae042ea10a3cf6a5dafe4015ed86e0a484350dc433f7870f8b3069dcbeeefb4c00b9abfbfe0a97419fee479985525b018c71d686ea99adf70afabe29d392e5fab7535aaaa05cf362e9797d5f4269b16e7c9e9a6b45c48a29de93a5c44e00efc4bae4c730e77810d00db122b86ea9997d9a7a0b1b677c589e9c6a97c8b548aedc65be6eed71e5f6e603aee2dca7fe352a0ee7c041c597131b9e46d867e48e0a3c81628f082bea4868c487e8056734a2a2396e6ee7e730e3dafdd3ee268c422ce667f5ca4e9da3093eb1d3fc8d504691a1a0c5c7b12471ccb63a64222cee4e4e1f212a44ea1446c0dc03696003c7a62a8e4ad0627d7f55c638c775180c4cbf9ed92ac46dd54210a0212e0f88a7cdd5a87c12199fe0bd04f6524fb0a986c96144ebcc6763dfa6e2cf962600a88c010f9a2798849e8e87651cc26d23624bcdca0be537eba155c61dee81dd13a49b7a657527684fa9bb5f8850311cd4c2fceed60b25fab1439a7b5da79af49b410da8329d16fea6d653116432e9cc09ea6d25fe860d30594715512af8f0e160989e17109951d299016c54a3434ee9f9f1f4123155e2c6670b3472acbee2c20c125f26032587857576e4071dea5d5ed935407b599eb9ecc1dc044356862210109d7e875cc0e4febf92fa18d688b4c62b3fda45953b9cd8f78b95573fb94707c30822179ef41d70056ee8f4f67c81a94064c43aaab8b737b6cdc14045ae5ab3280c9a5a6669c43c59956fec9fdbf7c677b6a52e7bde7273f20d778d3cef557a624cb953951b6085384cbc2e0bf93e26779011ee3d7e1b687da115aeae8f0112bf470c0a04c62dbae988d460bf62695f98e9d0d25d72fd96c55105be504e485e0f300e9dbb4ac3643ce9d32390efbc2776ce95ef6a2d0ee9ca9b72ee616dd938f7741236faf8c1dcf3da884e065930052f10d8b6bd384f6428e07afeb2badd27cbe93b9f4d521c993d0895b8dd3223500897b4248966218e3b1cd0e01c3e2b1822352718974fe0d3a30de4788ace096e025c53f00f0b8905735e55667a9c5baa567b4b6701b61b97ee1a84b19624432d7555ad0187e149594ec00ea9b149b7784d9a8d45e29b2fa512fee6bb75c14bb65f85a07daaf9c219813503afb6d7e27e541df8168d6c2e6739ae9ed10eb4d053bc71451abddb3268995e994a95b441b59bb43fda3ad5a4ad0eaf568f746a55c1bbf6da3bf1e79732e1da81aecb523032cb62b4496120452dc4dabaab480e216580f47aaf4f9a14d9486c6e2090502f04347c40a3add1d3289f46b8f3406323ada0a367ddcf4a088c5a6f0d9de9156827781be582eea8e341b6271feef992188389966eadedf641818b0cfd36825555b0fb1197858eb75b97d2fa8aa28ad9122837547484d0d7e4effb394261b7d624345caaf4fd12868e919db5c7dd0c656e9fc3ce323d495380a3f2fc00020f15292d7490eaf0198d8f9ab9bae700000000000000000000000000000b10161e242c363d"
    })";

    const auto tx = test::from_json<state::Transaction>(json::json::parse(input));
    EXPECT_EQ(tx.kind, state::Transaction::Kind::eip1559);
    EXPECT_EQ(tx.data, (bytes{0xb0, 0xb1}));
    EXPECT_EQ(tx.gas_limit, 0x9091);
    EXPECT_EQ(tx.chain_id, 0);
    EXPECT_EQ(tx.value, 0xe0e1);
    EXPECT_EQ(tx.sender, 0xa0a1_address);
    EXPECT_EQ(tx.to, 0xc0c1_address);
    EXPECT_EQ(tx.max_gas_price, 0x7071);
    EXPECT_EQ(tx.max_priority_gas_price, 0x6061);
    EXPECT_TRUE(tx.access_list.empty());
    EXPECT_EQ(tx.nonce, 0);
    EXPECT_EQ(tx.public_key, evmc::from_hex("b543b479d32596ff68142e1b094d6c5bb163637cdb1a7823545bbb247216c3eb88b3cc84994aecd8b2efca728e5b7d230aeab46f170fd728959fe12adaa224db67821612405e10f3ffd7ca17cbe6d334603df756982676098c4b312043c28e9ac4333c6adca787b626df488a6073e625ec15b43ad996540ff4acbc0399f86c3b71db66c34b418f88649a15998cdf66d2df70ec147b7806fa2af6e474a17fdf4fbfb9770fe667639cce85afe43af7921a25c47b4a90f681e2014444d2d1dd72e8425a3212dea2e32027c12d04f694fd760c3807296604d8e75bfc391227a07d8e94268bb05fdc6d60c2ec5295148fa440fa519199e8d71cef5d6273f41c6b97b45a78eea4b95ec1be66f68333a8aafb9a54afae1d2df212f0242a91fa3f7a56e41cceb5371e0e54e54e91e3a845ed4002b37d1b7fc9a38fa519403d5777ebeff4e670db5b5756d4528891bbd1633ea971e5abd94fd3952aa16a93ccac79ed0b7a3bfe61b9c8556540665d3f7671bab015a9558b30c16c664637e8f597f6f5f12438bddd3a6a8425c1d43e4f6284f06fc1fecd08e409d43e7f27bd7e80ced2d20a51de41e3d16c772b417a76e6a70bff7e7d77befa243a669ce8ff11c925f1f892cb77af590861983bfa5270dd0960cad197fb903b71cae817352bf9345cf6f1d764a66c5921f8fac3c85c03b32920ea152664d0a6cdc6ce1f972341bddcc6c5f42cee426c40957e2333cedff343f2be9a351b89cd7dc561eec8ae89f7e470d5248660c419dab6958bec40c7c660ec10ee2cd6b45f14e66bcc171d53b973191bed67d3a6dccd74658a483afb735a86a0c554aeb9ada238075c1804ac11930c268930d8bd9e43c2e2d961c0133a3e74661761b3020f772a2abdaa897679916c3b03c151224245e310d9be7f8d1720ab98edcfee9b9940e1524a3a31a17cf5a519ca0e798be339780484180d612286f74b6c050fd4b1afc7021fdf631acc8ba06fd203f149af1c3fe975b0a8118e23c888fc21a60b91acbc420cde6485291cc7d28a0cfcb24efd3458cef7a676dfa10f3d83decb681d48887d7bb49da95fa4f37eca3ffba930421924a20dcc5c3e18a4bac0ffa63d33d62bb2a35a42bab8daf98fab963d1973de9eca38a40e13afc860c06ab8f5e1d20204167871ceb7205530e76720613b009465bb96d6d0554d7f5cbb278fa43e27435a4900464527d42b5960554cc1de5c65cce01532e389fc8eef02f82310ae0965b005f408ce5869b12760660f3da490d9df0477f9afddc03385860014fb921e623ff675dfd9000ad648ccd07eaaeff6ad640c71ad1e23b4bebb16c4aad8a59c4601fc92b70e7269cc9526226c77ed430827efb0fc8ab78e6f16005a138635ad39d365571195a5429a8998a90309ce489186c2cb902ef7a6982bc4b2693abb911d75643877361189cb0d72c08b5eb8c820589cf4e5fe4d46c8721d6a021be1765b2d6c49718a87a03e675d108af6fd9b48f5abca6d7409b1fee92cb5145b9b76d669fce00f9ed6a1047f722b5b4ebfc80f3297ea615bd64ecf51b8777b3a67676d7c48e842bf80f7b84fe3932e58965aff87506739d8bce9792c86c78d43feb83c75008962cc9f4a2e9a52cb94745096cde33f60ad603646f29e317c0ff78c0a3ea200f665aa7c7a4faf338cead6a8ed91b87762cacfd49108ce5c1ec5719cec1cedfbfab64e2aaeb39eecdfae2a3a68df4ea4789c11d4f14fdb034c45c6edecb250cf61c84636ed220289ca958790acb106327705bef2f5cb4f5dd15ae03ed74ef55fffd24d2d8fdd8ef59d990ccf0a418afd23668108e926489145cd6a3e976094a6815962b0a8d45d4cee03ee53fd57e929248e1b6f077b16b6cd5e3e0e08f94bd87df1c360af983c995c126acc3ce00cb19d2dd673e0568dd014713c54d764b6f200a7efada394a44236b765d76261b07d69b76c6427a4433c4617b1503888d88c360636d8090b6dbd5cd2b8c9d83ed82180a150c663ea84d6cfcbad3d52a8b95854baaca3139c8ba52e4a2f6b5589ec77a6382eb502042687f4787b5daa8c6c48bc1d34dbb98a052e52b92a5d2fb5d3dfa0e590c187d93724d497cda403f574b70b1668e3ee2e86a6875135b4bec11a83d853ccebab523360de8cc0fef2594526a81643cef955d78846a7eb8db22b9b225c631d138c3d30cc95b8dea54385d6074a90db216ad07687b1d2353a9e657e61e09a5820cbc1aac4dc03725c60fd48f27b6f0f5420811b30e3bf3b194187cf65ace99d07f54e5b06b43554d63095ec6c3ba13bdcc115155614c7d27ba1940841435111d353251c90bc008e7138e0101b576a2bd60b5e14b4a9cfb51c06dc28681a6afd62c791309e618bfaebebdd59673cf0f5b5aa683816425c0bd1a36bf6f2e74e56db16d8bacd07c851ff6f83f59f38e7aad7479710327487bf176c097ba075191dc67fbdc058ef145a63a5e9f7bdf4904d82ccdb1948790ce99d0144aa12994dc4caee920a2dd5c2bb2c6159374f2ad102d640b7ee7fd94f87807b0eb17d5a676f30b6891aac832b3a541c803711b443dbee27c781471223e5a537312b2e789759bd914c0449d47e42f2690b50762ac4881344e55963a5c77234ef825889de8aadb45d8e9be4977f5868eda16a7744c4c7ade92c804157149005d2b6fb74f730d1695831b7a18c89e87bc2068eb943fa5612e6d130ada284c160d29d2a17ae60df3e8edda822f5c9cda318b51dd65d398d06e58a43ed2b8ff74aa9ab9aaf9c3e8765ba0a374dec4408baabe153a22971407de08ef7d10d20ae6318555f78af959d9a79e0ccf07f250e0f1ff0d900811f1f8fa695c8daace0bb2dbb44f4499e4be4afa47a0c3cdf89aca059a7b4851fd51713c50ba353b7ea9541057270c04c6b9adce2db02f2bade95f34c1b2e0045ac583b6526920031de3ab9bbea36e5ef91a8a012f62ee4803ccd168488d8490467838524f061d40416c4646f81e375937d90eb75d6ef7c36681023191487154e0c25374f8fd3a5d1891fe76c2201d29e6f6bcdd969bebc5512f84e52164fa1694dbce1bd034e5fcaef6ba96ec8945c49099d9dfc61f4d6f8b1ce22f0843ef649b09b67f670d029716855e4aa3f82651ddcce85b765a04eebe30cc8eebf85e69658d5dc19f705c27c989015ecf774b147059c8405c1bae15bd2c7b4a3a7bebed8729daa7f962a75708107e2445f975c3075eecb05439dc4b66b4cd8bf57392bf7be31682ae214049536971ddf7eb8e5b62d359b4c8097333b6ac423ca35dbcc52daedbcb9dc4d8e811e6c281794bfd676e78e675dca6ddfc1da8c05d54d990aea0e7050b75dc57473bc6ca0c6bd9d018a0f3d406816b89e90eb17951034da9f68dfb2736b0c42f4f98ad2301288436dd21c944485e8e084e0408e84e1946e67230730c6af3620f64475dd62fe614fd01a18952d8b396676f747107c467d37b12be91fe164ae083e5ce12f5e8c2a7bccea9f75ff8ea40cc2f8a4fa521fcd92adc7e5b1187ce7e233d7e98c8782b30ebd9ef9c2f15feb6373751accb6eba57b1ead3af4bc5a2b2b4acccaba442fbfbde89ac8ea1e5f9bbb5c122ce22a53371250a58e5d7a735419cc32a8ab047cf097253f8a84dfe64c208b0b0c80e5930cb26ce93f375eb3c1db4bb7"));
    EXPECT_EQ(tx.signature,
        evmc::from_hex(
            "131cea321925fbfd34681919d181826208ee5e27280a0882101b8072cf371aab14330a0fa303e2cbbc5ab5"
            "bd5f54e23077563a75f4f261e05ae6a7d55a92e8fe0b8c899d8b5145723c23e3d606f7797099866e0f4075"
            "dcd0f68c5a86295a4d1414acf5a14d22392477a96e12b4ac9f554f522381d9a641d888f1f4d0bb18092adb"
            "ac3578c737233f9c39ff1ee7a23449d6b5f43e30dad56d3ac83a324fef6335faaab40ffaab92c1c9575d28"
            "645c2681031ca51141ee13d9dbf79fa0adbcb04b582fc6a41f6e9d13a1c5ebd89430c67e0cebd70905420b"
            "e18465e6db742b117fb39b29613b7f29bb028535cfdc3e9fd2d498ce3c03947a1c28c1efcba723aad5599f"
            "6b9a1800cf47238ebf0c4ba4c0fc525302b16ada42d13511c4d231beca31ac680a8ee2ece5714705451160"
            "e3f8a9d2c2b8d1e18fdf2a9b38a0ef4bc1bb476fcce8a06e5d5f3f0f5f1e629b47670b093955fd2750ce3f"
            "d9b331b4f009d62fc07f86b18e6ecbdfc742f348836cd7abcdcf48f2c75960d01617007b4ac89ad220eefe"
            "9f933acfd1677513c042ba32e4d7bb1a4cd7d453b37e7a36770dac2f0e20a45ba8ca253d6bc87599e9b8c2"
            "0879d6bbd30e116a219661cabe9e219abbbb6972bf9374817f4bc73528b0ae9831545571f3645dd9b210b5"
            "858570951cd32e3d81fe083073352d962d0c6ac212587fc99ad76a7dc15679e236f29cf33c38d7ae6ec364"
            "688f53f0a0d93875b6b8f969f5123579ca0311ff521a91f4e3010fc6863adc4c8056f41bd8441f38e6d197"
            "acf06ba452ddc2ed17156725a9db5db8aee34144af0f31bcdc8b15af8190351fa68656ff5f6cf0bf453452"
            "39fb0097cccca7536b81e08fede797118a5e10e1427f06e95e70a97b426bc2b1326eed13a07877958d2586"
            "d42552b41ecf1fcad21f59dc9c4d48837eb6fd0f9f20e3cda3f427f9d371abc99706596680c1bf068c238c"
            "361cb85f31c391662f9cbf6404144a07fae246da521d98fe21c039677f87f32357aa727ca8e5811f7a4af0"
            "c28eb800e734ec42332092133a77ad5a757f0f73ad8d0df0c07ecaa09dd78349b500c6bff466750107a1f8"
            "b9f3c8ff251b7026b1de0fa7a57806f447f5817f670aad99d89fe88e997f4f1c3f4a474bddfc424245a604"
            "2f923cad0d8b7a3ebdf005ac3138f7edfeab5b7d6a642f4b41d2e2b0b342bbdcb677d1440313fcd003e3cf"
            "6a18be70172f0f6ee0a5545a5dbd1902d0d9cadfb7e74cb4946364a81bf8d8440fb006b3ee0ccfead39209"
            "c4db55bcd339ce6b97d9016d30aa82118ba1a169daae06174c9f375fb02c6857925bd112c08307a463c46d"
            "94a74c6f61e8adc2eb3cc9fbdd6177ce0fce161aca2c23d424e1a3d8286f524bb73f5c4268dc3b10477758"
            "743780eedc9ef0aca5f24f1782dfb771713b8a04100681d8bbda636fcbb4cbb4eb38b84b9d038f5af5815d"
            "c0caa4085f0e75f06b4a23fcea2bc9673be28ff4f08f3b8f1da7d9a1b766e7858b7c9d07ac793395e240ec"
            "9479c9b6d1be8fdcfa034d596c21cca6a654ab8dbb86f4fa96cbb638ac79fcfb52f1758b2e25fa713e9d00"
            "cb1d049e05beb06a5fd7a41546c27f48e0d570361b3583ab0e3a8f45d66d26fb9ae45e1c2f5e21ecc6fdbe"
            "1a8887447407e6e846bdcc0c4503bdc4d1251413af44c4211ba2693f7739e608d4fae117298d5b54bdbe49"
            "d956854e652ac4fca43e754c5b9f7f6c07c8e591770fe5ec88250ec08a5c2aaed6ab0b547e7420522146a6"
            "08488120da81f12a6812b6811224d8dcfddc3c2029cfc57f38d6c26b55006ae38332413a30981871123131"
            "dc9f59726abdb9ddcabb45cb681f2a9ec768dab64d0e91950b5a4402fb84600dfcea66ff9579a89b2310ab"
            "84940c7b4cafafe4b5401fb6b96d33595e3b2fc6d77caa4eb5acdc4e60ee2c825bdf9dd042ddb58ba228f0"
            "ffed3164fe5be4bf4c4c278b7d8002fba4a51ee116b16319da4e580bcf930bb354639554ec469066ac4b01"
            "d2fca1273c006bd65d9be494638e26e93871f6053cccdbc42450693d41d26baca77f2da4d7dc94f089fedb"
            "29da25968dab109a634d010dfe91bb04c7047151485412ff1a84cd7daa44c830b9767dac473b7d0f1da7e6"
            "2c53c8c5ef41cdabb4b4a55cf0a37e6a8ca522d4f0ca6cec0ca4d154684a9123f4cf2573a013abf04aec34"
            "3e79458b3510377a10d6a0b89a8f0abb52f1a77013357faa9e3ec2086c2dcc9299e06993590bcf3ee43d4f"
            "5a0a56830acb876af929ff56ae63120e7e33d040e4697ed3819d17878badcfef17ce5fad90c17e29448665"
            "ca0dcafcc891f696a50402eb9c96c517e5eb7e796b05db330d79e9e74ef8e14d22174607258ed4c704c11a"
            "c617b02cc4b628d7911acb7ab67def265a0cfc02a6b5e2b73922fc8be941d31cc192a113f70f803b6467cf"
            "0ce3b96c3cd6d652c6d11f98af06a12cd993b80daca08d16bd71b265218b62af36cf1ab5d975a13743f3ac"
            "ee638203cea0d1e54875b396d950036f3209620a487306589f9e4bf5ac88f3926fe93b8465ff50689f26a3"
            "58d9461544a0c5484750333b75a2b8d471f962b1a7ae288372f06bfcc75b35721d551018b1604234f97a04"
            "d9dcc1dfee735857074ce8c2afed249add41226f0fa401bfd6d80b97d13648c62a50240a39bdcc0c5c6537"
            "01bebee3fc0bee0650f4f27fb0701933b56766c4de3bce8750fd88fadf2bccb6c2e520422431474371e949"
            "091b36e89fddc0c63bcd95602f423e91eb7dcd4735ac41b47aa65b2ebdca4f7905c9282efd26ae7abaeccf"
            "329833b1135f8ad520c9ec36eb919e3793ee40ee6d393957aee78ed6afde608c43c985608c40a6e6ebc91c"
            "5b3ec7788ea17e30ba5752dbc22944e3a63615c42654f88f7f559b8dfc3addc60a94e3f22d023cdf9d67d3"
            "e0927e43f7151e335ed488716b34e22c67cb4ce5b2d8da9163d5ed5e582fcb05886ebd01f4f353bfe794bf"
            "a4b9f55ea79cc865f67a5d1a2536da33efba5fefcb368ae071ddd4ff58b201011e7a631d272adc15fab9ed"
            "46c5b8f5c0aad75f550327f738222713f9a752f754ee1bfa18b671c741d3ec6492a8525aea8428754b51b1"
            "90cd4d290f8b1d470cf4b75ca541e8efe67ea38166c307958822a48e79c9cb7c83112009f47686d11bdc25"
            "bc3d1519e0e452967ccef3cf47669584088849de602afbec9c7d64951d6a4ad92a49d981b67d3a992bf83a"
            "9bb021408a2255186d9b7c229a51b505a5f8eb2603fd8822a2de8ca3c583bf9f373614ee905a6ebe2b478d"
            "0f07c1b790bc8c1e5db7f81511a12878dd97c242e9dffe8dfd087e17dfbe885132a4399136ee663f4d94a2"
            "e58dac1b8abfeaef38d7404802a72c2ddfc36591c27c5b369ef6174fa07e483a35d00101479e350e047f8a"
            "dfc49e28862ea360dacaa9f52b8b0f5e2816bf80ad62906830f57d59357ffe7326e8f6e2185c026634e673"
            "46e801419473de2934f555b2061f9b9b459e71bd704c9156e0193fb12a6b8fd49719b21249ab8953ce04df"
            "037da1655c0ac0c3a25fec70c90fd18bf51946c18147f9e6a3287895f4d6183012701ded7de25ee3616b72"
            "37d910d42b065bc5e554b51d07f3e98c240e0a6c019c74075996ab23ad217daebd1f5c0bb402f597de5159"
            "235bc6589b76b94d7532b86b3d6728386ddffefbae921be8d05074011a75b63640829e68e2d4b70ecbac16"
            "37e4a9a77ee9ab8179d35ca0256b357a00dd63c792a1ad5ca259956a1b1a51f7819793b68443e2b28550e3"
            "3a07d360b214581cbc367a87512d1dd758ce2e9f6196046412c942613b5ef4dce7c7fe07bbdf425eb0afab"
            "16192561bab9e67b06f47c461a9f5b3baae0f27ddf3a9812836e9debb961ebdb4cc377edfbc05a610ce8f7"
            "ce9f12e3c4abb6ca51b96323b204b48dfa8abeea27785c273a9d700c8f8fca96e1d1a2799fb23a045ffd58"
            "ca485bfc9d930ccee781beac3560f45909414806faf0bb8fc6657384c13fcd5e9da7b79834292dfd641869"
            "0b03cb6718b7c9637fa918f6a9a19d3dfe3a76d96bb3c0db0fd6751b9a394b55460042036e0b85c1e135a2"
            "a9d37dd871afa405e4ae5827c47e657d9694f51bee74768b03ee9e7b8731919e962cfaec19439e5eaa40f9"
            "2e7094de8ab6c0a91b451b6d0cbefa9e44a471ca1549c78e66a2c622dc07294fa908e0e64e100c3550edb8"
            "c31f302f81aa8e154e9f666cfe904145a9c7ecdb3765f60c7ba06360df5639ef684653a5f90bb47510d035"
            "7cd5f0de0ed0419477b6af059f01948954b3844627853bb23fb76861fed81a09a03ce4a4c512dd91bba59e"
            "72aef3936290979d93222667ac31df7514e5eac1b53efdda607215af47a813af08588d28cd9c2ef93985b4"
            "7bd6e833ac07de0af0aeeb92ad36af2c05f47d6a31ee75e19b841ffc79ae865edddd97865b7f661aed1579"
            "22f93903884cc6d489d8f1a6160c31509b9250c481c9d9ed99778e90a38969549c563820a13ebb5dd0184d"
            "fc58d28614ce1522bf4e99724e9452f64592ab01424035581780653d5093468c555dfc52ac86e43644e0f3"
            "f89d06c7cc0d6566bde0b2fdb896665425e5cc80bd4795247217a08f16fdf9e522ff7868b01598e0b8a41d"
            "a2221fdb646409eb102107a20d5ea06ea3b3c0139d02480be6e42cc00b2a32ccdd0eeeaea90e1dcbef4bbd"
            "7b7100a74486354ce5baa8a230ec7c58e1f9269124057c491c48a02159cf3f37375f8bfaeb4eafd6fa9d82"
            "09dbcba61c8d189171c313ac75ed7d69f5b16ee60ee7cfc0f98d76796643d2bf4555db2b3604914e06b2c5"
            "5dc62607bf622956705762005ceeed11599871f89cc7e2d4d86231bec5d423382e77f9707c41d6062efc56"
            "512e6339e34b64152393e8d42391b6311423f8730a85261375e5fcd5cff5f26abb6faaa75e8f8167cc6374"
            "f8f3fbe10b688f292fb4cc12c93f678b8f5110cd8baaae7e8ba05a11f8b469adb853f7d20fe2d6b8f0980e"
            "83ec83ae042ea10a3cf6a5dafe4015ed86e0a484350dc433f7870f8b3069dcbeeefb4c00b9abfbfe0a9741"
            "9fee479985525b018c71d686ea99adf70afabe29d392e5fab7535aaaa05cf362e9797d5f4269b16e7c9e9a"
            "6b45c48a29de93a5c44e00efc4bae4c730e77810d00db122b86ea9997d9a7a0b1b677c589e9c6a97c8b548"
            "aedc65be6eed71e5f6e603aee2dca7fe352a0ee7c041c597131b9e46d867e48e0a3c81628f082bea4868c4"
            "87e8056734a2a2396e6ee7e730e3dafdd3ee268c422ce667f5ca4e9da3093eb1d3fc8d504691a1a0c5c7b1"
            "2471ccb63a64222cee4e4e1f212a44ea1446c0dc03696003c7a62a8e4ad0627d7f55c638c775180c4cbf9e"
            "d92ac46dd54210a0212e0f88a7cdd5a87c12199fe0bd04f6524fb0a986c96144ebcc6763dfa6e2cf962600"
            "a88c010f9a2798849e8e87651cc26d23624bcdca0be537eba155c61dee81dd13a49b7a657527684fa9bb5f"
            "8850311cd4c2fceed60b25fab1439a7b5da79af49b410da8329d16fea6d653116432e9cc09ea6d25fe860d"
            "30594715512af8f0e160989e17109951d299016c54a3434ee9f9f1f4123155e2c6670b3472acbee2c20c12"
            "5f26032587857576e4071dea5d5ed935407b599eb9ecc1dc044356862210109d7e875cc0e4febf92fa18d6"
            "88b4c62b3fda45953b9cd8f78b95573fb94707c30822179ef41d70056ee8f4f67c81a94064c43aaab8b737"
            "b6cdc14045ae5ab3280c9a5a6669c43c59956fec9fdbf7c677b6a52e7bde7273f20d778d3cef557a624cb9"
            "53951b6085384cbc2e0bf93e26779011ee3d7e1b687da115aeae8f0112bf470c0a04c62dbae988d460bf62"
            "695f98e9d0d25d72fd96c55105be504e485e0f300e9dbb4ac3643ce9d32390efbc2776ce95ef6a2d0ee9ca"
            "9b72ee616dd938f7741236faf8c1dcf3da884e065930052f10d8b6bd384f6428e07afeb2badd27cbe93b9f"
            "4d521c993d0895b8dd3223500897b4248966218e3b1cd0e01c3e2b1822352718974fe0d3a30de4788ace09"
            "6e025c53f00f0b8905735e55667a9c5baa567b4b6701b61b97ee1a84b19624432d7555ad0187e149594ec0"
            "0ea9b149b7784d9a8d45e29b2fa512fee6bb75c14bb65f85a07daaf9c219813503afb6d7e27e541df8168d"
            "6c2e6739ae9ed10eb4d053bc71451abddb3268995e994a95b441b59bb43fda3ad5a4ad0eaf568f746a55c1"
            "bbf6da3bf1e79732e1da81aecb523032cb62b4496120452dc4dabaab480e216580f47aaf4f9a14d9486c6e"
            "2090502f04347c40a3add1d3289f46b8f3406323ada0a367ddcf4a088c5a6f0d9de9156827781be582eea8"
            "e341b6271feef992188389966eadedf641818b0cfd36825555b0fb1197858eb75b97d2fa8aa28ad9122837"
            "547484d0d7e4effb394261b7d624345caaf4fd12868e919db5c7dd0c656e9fc3ce323d495380a3f2fc0002"
            "0f15292d7490eaf0198d8f9ab9bae700000000000000000000000000000b10161e242c363d"));
}

TEST(statetest_loader, tx_access_list)
{
    constexpr std::string_view input = R"({
        "input": "",
        "gas": "0",
        "value": "0",
        "sender": "",
        "to": "",
        "maxFeePerGas": "0",
        "maxPriorityFeePerGas": "0",
        "accessList": [
            {"address": "ac01", "storageKeys": []},
            {"address": "ac02", "storageKeys": ["fe", "00"]}
        ],
        "nonce": "0",
        "publicKey": "0xb543b479d32596ff68142e1b094d6c5bb163637cdb1a7823545bbb247216c3eb88b3cc84994aecd8b2efca728e5b7d230aeab46f170fd728959fe12adaa224db67821612405e10f3ffd7ca17cbe6d334603df756982676098c4b312043c28e9ac4333c6adca787b626df488a6073e625ec15b43ad996540ff4acbc0399f86c3b71db66c34b418f88649a15998cdf66d2df70ec147b7806fa2af6e474a17fdf4fbfb9770fe667639cce85afe43af7921a25c47b4a90f681e2014444d2d1dd72e8425a3212dea2e32027c12d04f694fd760c3807296604d8e75bfc391227a07d8e94268bb05fdc6d60c2ec5295148fa440fa519199e8d71cef5d6273f41c6b97b45a78eea4b95ec1be66f68333a8aafb9a54afae1d2df212f0242a91fa3f7a56e41cceb5371e0e54e54e91e3a845ed4002b37d1b7fc9a38fa519403d5777ebeff4e670db5b5756d4528891bbd1633ea971e5abd94fd3952aa16a93ccac79ed0b7a3bfe61b9c8556540665d3f7671bab015a9558b30c16c664637e8f597f6f5f12438bddd3a6a8425c1d43e4f6284f06fc1fecd08e409d43e7f27bd7e80ced2d20a51de41e3d16c772b417a76e6a70bff7e7d77befa243a669ce8ff11c925f1f892cb77af590861983bfa5270dd0960cad197fb903b71cae817352bf9345cf6f1d764a66c5921f8fac3c85c03b32920ea152664d0a6cdc6ce1f972341bddcc6c5f42cee426c40957e2333cedff343f2be9a351b89cd7dc561eec8ae89f7e470d5248660c419dab6958bec40c7c660ec10ee2cd6b45f14e66bcc171d53b973191bed67d3a6dccd74658a483afb735a86a0c554aeb9ada238075c1804ac11930c268930d8bd9e43c2e2d961c0133a3e74661761b3020f772a2abdaa897679916c3b03c151224245e310d9be7f8d1720ab98edcfee9b9940e1524a3a31a17cf5a519ca0e798be339780484180d612286f74b6c050fd4b1afc7021fdf631acc8ba06fd203f149af1c3fe975b0a8118e23c888fc21a60b91acbc420cde6485291cc7d28a0cfcb24efd3458cef7a676dfa10f3d83decb681d48887d7bb49da95fa4f37eca3ffba930421924a20dcc5c3e18a4bac0ffa63d33d62bb2a35a42bab8daf98fab963d1973de9eca38a40e13afc860c06ab8f5e1d20204167871ceb7205530e76720613b009465bb96d6d0554d7f5cbb278fa43e27435a4900464527d42b5960554cc1de5c65cce01532e389fc8eef02f82310ae0965b005f408ce5869b12760660f3da490d9df0477f9afddc03385860014fb921e623ff675dfd9000ad648ccd07eaaeff6ad640c71ad1e23b4bebb16c4aad8a59c4601fc92b70e7269cc9526226c77ed430827efb0fc8ab78e6f16005a138635ad39d365571195a5429a8998a90309ce489186c2cb902ef7a6982bc4b2693abb911d75643877361189cb0d72c08b5eb8c820589cf4e5fe4d46c8721d6a021be1765b2d6c49718a87a03e675d108af6fd9b48f5abca6d7409b1fee92cb5145b9b76d669fce00f9ed6a1047f722b5b4ebfc80f3297ea615bd64ecf51b8777b3a67676d7c48e842bf80f7b84fe3932e58965aff87506739d8bce9792c86c78d43feb83c75008962cc9f4a2e9a52cb94745096cde33f60ad603646f29e317c0ff78c0a3ea200f665aa7c7a4faf338cead6a8ed91b87762cacfd49108ce5c1ec5719cec1cedfbfab64e2aaeb39eecdfae2a3a68df4ea4789c11d4f14fdb034c45c6edecb250cf61c84636ed220289ca958790acb106327705bef2f5cb4f5dd15ae03ed74ef55fffd24d2d8fdd8ef59d990ccf0a418afd23668108e926489145cd6a3e976094a6815962b0a8d45d4cee03ee53fd57e929248e1b6f077b16b6cd5e3e0e08f94bd87df1c360af983c995c126acc3ce00cb19d2dd673e0568dd014713c54d764b6f200a7efada394a44236b765d76261b07d69b76c6427a4433c4617b1503888d88c360636d8090b6dbd5cd2b8c9d83ed82180a150c663ea84d6cfcbad3d52a8b95854baaca3139c8ba52e4a2f6b5589ec77a6382eb502042687f4787b5daa8c6c48bc1d34dbb98a052e52b92a5d2fb5d3dfa0e590c187d93724d497cda403f574b70b1668e3ee2e86a6875135b4bec11a83d853ccebab523360de8cc0fef2594526a81643cef955d78846a7eb8db22b9b225c631d138c3d30cc95b8dea54385d6074a90db216ad07687b1d2353a9e657e61e09a5820cbc1aac4dc03725c60fd48f27b6f0f5420811b30e3bf3b194187cf65ace99d07f54e5b06b43554d63095ec6c3ba13bdcc115155614c7d27ba1940841435111d353251c90bc008e7138e0101b576a2bd60b5e14b4a9cfb51c06dc28681a6afd62c791309e618bfaebebdd59673cf0f5b5aa683816425c0bd1a36bf6f2e74e56db16d8bacd07c851ff6f83f59f38e7aad7479710327487bf176c097ba075191dc67fbdc058ef145a63a5e9f7bdf4904d82ccdb1948790ce99d0144aa12994dc4caee920a2dd5c2bb2c6159374f2ad102d640b7ee7fd94f87807b0eb17d5a676f30b6891aac832b3a541c803711b443dbee27c781471223e5a537312b2e789759bd914c0449d47e42f2690b50762ac4881344e55963a5c77234ef825889de8aadb45d8e9be4977f5868eda16a7744c4c7ade92c804157149005d2b6fb74f730d1695831b7a18c89e87bc2068eb943fa5612e6d130ada284c160d29d2a17ae60df3e8edda822f5c9cda318b51dd65d398d06e58a43ed2b8ff74aa9ab9aaf9c3e8765ba0a374dec4408baabe153a22971407de08ef7d10d20ae6318555f78af959d9a79e0ccf07f250e0f1ff0d900811f1f8fa695c8daace0bb2dbb44f4499e4be4afa47a0c3cdf89aca059a7b4851fd51713c50ba353b7ea9541057270c04c6b9adce2db02f2bade95f34c1b2e0045ac583b6526920031de3ab9bbea36e5ef91a8a012f62ee4803ccd168488d8490467838524f061d40416c4646f81e375937d90eb75d6ef7c36681023191487154e0c25374f8fd3a5d1891fe76c2201d29e6f6bcdd969bebc5512f84e52164fa1694dbce1bd034e5fcaef6ba96ec8945c49099d9dfc61f4d6f8b1ce22f0843ef649b09b67f670d029716855e4aa3f82651ddcce85b765a04eebe30cc8eebf85e69658d5dc19f705c27c989015ecf774b147059c8405c1bae15bd2c7b4a3a7bebed8729daa7f962a75708107e2445f975c3075eecb05439dc4b66b4cd8bf57392bf7be31682ae214049536971ddf7eb8e5b62d359b4c8097333b6ac423ca35dbcc52daedbcb9dc4d8e811e6c281794bfd676e78e675dca6ddfc1da8c05d54d990aea0e7050b75dc57473bc6ca0c6bd9d018a0f3d406816b89e90eb17951034da9f68dfb2736b0c42f4f98ad2301288436dd21c944485e8e084e0408e84e1946e67230730c6af3620f64475dd62fe614fd01a18952d8b396676f747107c467d37b12be91fe164ae083e5ce12f5e8c2a7bccea9f75ff8ea40cc2f8a4fa521fcd92adc7e5b1187ce7e233d7e98c8782b30ebd9ef9c2f15feb6373751accb6eba57b1ead3af4bc5a2b2b4acccaba442fbfbde89ac8ea1e5f9bbb5c122ce22a53371250a58e5d7a735419cc32a8ab047cf097253f8a84dfe64c208b0b0c80e5930cb26ce93f375eb3c1db4bb7",
        "signature": "0x131cea321925fbfd34681919d181826208ee5e27280a0882101b8072cf371aab14330a0fa303e2cbbc5ab5bd5f54e23077563a75f4f261e05ae6a7d55a92e8fe0b8c899d8b5145723c23e3d606f7797099866e0f4075dcd0f68c5a86295a4d1414acf5a14d22392477a96e12b4ac9f554f522381d9a641d888f1f4d0bb18092adbac3578c737233f9c39ff1ee7a23449d6b5f43e30dad56d3ac83a324fef6335faaab40ffaab92c1c9575d28645c2681031ca51141ee13d9dbf79fa0adbcb04b582fc6a41f6e9d13a1c5ebd89430c67e0cebd70905420be18465e6db742b117fb39b29613b7f29bb028535cfdc3e9fd2d498ce3c03947a1c28c1efcba723aad5599f6b9a1800cf47238ebf0c4ba4c0fc525302b16ada42d13511c4d231beca31ac680a8ee2ece5714705451160e3f8a9d2c2b8d1e18fdf2a9b38a0ef4bc1bb476fcce8a06e5d5f3f0f5f1e629b47670b093955fd2750ce3fd9b331b4f009d62fc07f86b18e6ecbdfc742f348836cd7abcdcf48f2c75960d01617007b4ac89ad220eefe9f933acfd1677513c042ba32e4d7bb1a4cd7d453b37e7a36770dac2f0e20a45ba8ca253d6bc87599e9b8c20879d6bbd30e116a219661cabe9e219abbbb6972bf9374817f4bc73528b0ae9831545571f3645dd9b210b5858570951cd32e3d81fe083073352d962d0c6ac212587fc99ad76a7dc15679e236f29cf33c38d7ae6ec364688f53f0a0d93875b6b8f969f5123579ca0311ff521a91f4e3010fc6863adc4c8056f41bd8441f38e6d197acf06ba452ddc2ed17156725a9db5db8aee34144af0f31bcdc8b15af8190351fa68656ff5f6cf0bf45345239fb0097cccca7536b81e08fede797118a5e10e1427f06e95e70a97b426bc2b1326eed13a07877958d2586d42552b41ecf1fcad21f59dc9c4d48837eb6fd0f9f20e3cda3f427f9d371abc99706596680c1bf068c238c361cb85f31c391662f9cbf6404144a07fae246da521d98fe21c039677f87f32357aa727ca8e5811f7a4af0c28eb800e734ec42332092133a77ad5a757f0f73ad8d0df0c07ecaa09dd78349b500c6bff466750107a1f8b9f3c8ff251b7026b1de0fa7a57806f447f5817f670aad99d89fe88e997f4f1c3f4a474bddfc424245a6042f923cad0d8b7a3ebdf005ac3138f7edfeab5b7d6a642f4b41d2e2b0b342bbdcb677d1440313fcd003e3cf6a18be70172f0f6ee0a5545a5dbd1902d0d9cadfb7e74cb4946364a81bf8d8440fb006b3ee0ccfead39209c4db55bcd339ce6b97d9016d30aa82118ba1a169daae06174c9f375fb02c6857925bd112c08307a463c46d94a74c6f61e8adc2eb3cc9fbdd6177ce0fce161aca2c23d424e1a3d8286f524bb73f5c4268dc3b10477758743780eedc9ef0aca5f24f1782dfb771713b8a04100681d8bbda636fcbb4cbb4eb38b84b9d038f5af5815dc0caa4085f0e75f06b4a23fcea2bc9673be28ff4f08f3b8f1da7d9a1b766e7858b7c9d07ac793395e240ec9479c9b6d1be8fdcfa034d596c21cca6a654ab8dbb86f4fa96cbb638ac79fcfb52f1758b2e25fa713e9d00cb1d049e05beb06a5fd7a41546c27f48e0d570361b3583ab0e3a8f45d66d26fb9ae45e1c2f5e21ecc6fdbe1a8887447407e6e846bdcc0c4503bdc4d1251413af44c4211ba2693f7739e608d4fae117298d5b54bdbe49d956854e652ac4fca43e754c5b9f7f6c07c8e591770fe5ec88250ec08a5c2aaed6ab0b547e7420522146a608488120da81f12a6812b6811224d8dcfddc3c2029cfc57f38d6c26b55006ae38332413a30981871123131dc9f59726abdb9ddcabb45cb681f2a9ec768dab64d0e91950b5a4402fb84600dfcea66ff9579a89b2310ab84940c7b4cafafe4b5401fb6b96d33595e3b2fc6d77caa4eb5acdc4e60ee2c825bdf9dd042ddb58ba228f0ffed3164fe5be4bf4c4c278b7d8002fba4a51ee116b16319da4e580bcf930bb354639554ec469066ac4b01d2fca1273c006bd65d9be494638e26e93871f6053cccdbc42450693d41d26baca77f2da4d7dc94f089fedb29da25968dab109a634d010dfe91bb04c7047151485412ff1a84cd7daa44c830b9767dac473b7d0f1da7e62c53c8c5ef41cdabb4b4a55cf0a37e6a8ca522d4f0ca6cec0ca4d154684a9123f4cf2573a013abf04aec343e79458b3510377a10d6a0b89a8f0abb52f1a77013357faa9e3ec2086c2dcc9299e06993590bcf3ee43d4f5a0a56830acb876af929ff56ae63120e7e33d040e4697ed3819d17878badcfef17ce5fad90c17e29448665ca0dcafcc891f696a50402eb9c96c517e5eb7e796b05db330d79e9e74ef8e14d22174607258ed4c704c11ac617b02cc4b628d7911acb7ab67def265a0cfc02a6b5e2b73922fc8be941d31cc192a113f70f803b6467cf0ce3b96c3cd6d652c6d11f98af06a12cd993b80daca08d16bd71b265218b62af36cf1ab5d975a13743f3acee638203cea0d1e54875b396d950036f3209620a487306589f9e4bf5ac88f3926fe93b8465ff50689f26a358d9461544a0c5484750333b75a2b8d471f962b1a7ae288372f06bfcc75b35721d551018b1604234f97a04d9dcc1dfee735857074ce8c2afed249add41226f0fa401bfd6d80b97d13648c62a50240a39bdcc0c5c653701bebee3fc0bee0650f4f27fb0701933b56766c4de3bce8750fd88fadf2bccb6c2e520422431474371e949091b36e89fddc0c63bcd95602f423e91eb7dcd4735ac41b47aa65b2ebdca4f7905c9282efd26ae7abaeccf329833b1135f8ad520c9ec36eb919e3793ee40ee6d393957aee78ed6afde608c43c985608c40a6e6ebc91c5b3ec7788ea17e30ba5752dbc22944e3a63615c42654f88f7f559b8dfc3addc60a94e3f22d023cdf9d67d3e0927e43f7151e335ed488716b34e22c67cb4ce5b2d8da9163d5ed5e582fcb05886ebd01f4f353bfe794bfa4b9f55ea79cc865f67a5d1a2536da33efba5fefcb368ae071ddd4ff58b201011e7a631d272adc15fab9ed46c5b8f5c0aad75f550327f738222713f9a752f754ee1bfa18b671c741d3ec6492a8525aea8428754b51b190cd4d290f8b1d470cf4b75ca541e8efe67ea38166c307958822a48e79c9cb7c83112009f47686d11bdc25bc3d1519e0e452967ccef3cf47669584088849de602afbec9c7d64951d6a4ad92a49d981b67d3a992bf83a9bb021408a2255186d9b7c229a51b505a5f8eb2603fd8822a2de8ca3c583bf9f373614ee905a6ebe2b478d0f07c1b790bc8c1e5db7f81511a12878dd97c242e9dffe8dfd087e17dfbe885132a4399136ee663f4d94a2e58dac1b8abfeaef38d7404802a72c2ddfc36591c27c5b369ef6174fa07e483a35d00101479e350e047f8adfc49e28862ea360dacaa9f52b8b0f5e2816bf80ad62906830f57d59357ffe7326e8f6e2185c026634e67346e801419473de2934f555b2061f9b9b459e71bd704c9156e0193fb12a6b8fd49719b21249ab8953ce04df037da1655c0ac0c3a25fec70c90fd18bf51946c18147f9e6a3287895f4d6183012701ded7de25ee3616b7237d910d42b065bc5e554b51d07f3e98c240e0a6c019c74075996ab23ad217daebd1f5c0bb402f597de5159235bc6589b76b94d7532b86b3d6728386ddffefbae921be8d05074011a75b63640829e68e2d4b70ecbac1637e4a9a77ee9ab8179d35ca0256b357a00dd63c792a1ad5ca259956a1b1a51f7819793b68443e2b28550e33a07d360b214581cbc367a87512d1dd758ce2e9f6196046412c942613b5ef4dce7c7fe07bbdf425eb0afab16192561bab9e67b06f47c461a9f5b3baae0f27ddf3a9812836e9debb961ebdb4cc377edfbc05a610ce8f7ce9f12e3c4abb6ca51b96323b204b48dfa8abeea27785c273a9d700c8f8fca96e1d1a2799fb23a045ffd58ca485bfc9d930ccee781beac3560f45909414806faf0bb8fc6657384c13fcd5e9da7b79834292dfd6418690b03cb6718b7c9637fa918f6a9a19d3dfe3a76d96bb3c0db0fd6751b9a394b55460042036e0b85c1e135a2a9d37dd871afa405e4ae5827c47e657d9694f51bee74768b03ee9e7b8731919e962cfaec19439e5eaa40f92e7094de8ab6c0a91b451b6d0cbefa9e44a471ca1549c78e66a2c622dc07294fa908e0e64e100c3550edb8c31f302f81aa8e154e9f666cfe904145a9c7ecdb3765f60c7ba06360df5639ef684653a5f90bb47510d0357cd5f0de0ed0419477b6af059f01948954b3844627853bb23fb76861fed81a09a03ce4a4c512dd91bba59e72aef3936290979d93222667ac31df7514e5eac1b53efdda607215af47a813af08588d28cd9c2ef93985b47bd6e833ac07de0af0aeeb92ad36af2c05f47d6a31ee75e19b841ffc79ae865edddd97865b7f661aed157922f93903884cc6d489d8f1a6160c31509b9250c481c9d9ed99778e90a38969549c563820a13ebb5dd0184dfc58d28614ce1522bf4e99724e9452f64592ab01424035581780653d5093468c555dfc52ac86e43644e0f3f89d06c7cc0d6566bde0b2fdb896665425e5cc80bd4795247217a08f16fdf9e522ff7868b01598e0b8a41da2221fdb646409eb102107a20d5ea06ea3b3c0139d02480be6e42cc00b2a32ccdd0eeeaea90e1dcbef4bbd7b7100a74486354ce5baa8a230ec7c58e1f9269124057c491c48a02159cf3f37375f8bfaeb4eafd6fa9d8209dbcba61c8d189171c313ac75ed7d69f5b16ee60ee7cfc0f98d76796643d2bf4555db2b3604914e06b2c55dc62607bf622956705762005ceeed11599871f89cc7e2d4d86231bec5d423382e77f9707c41d6062efc56512e6339e34b64152393e8d42391b6311423f8730a85261375e5fcd5cff5f26abb6faaa75e8f8167cc6374f8f3fbe10b688f292fb4cc12c93f678b8f5110cd8baaae7e8ba05a11f8b469adb853f7d20fe2d6b8f0980e83ec83ae042ea10a3cf6a5dafe4015ed86e0a484350dc433f7870f8b3069dcbeeefb4c00b9abfbfe0a97419fee479985525b018c71d686ea99adf70afabe29d392e5fab7535aaaa05cf362e9797d5f4269b16e7c9e9a6b45c48a29de93a5c44e00efc4bae4c730e77810d00db122b86ea9997d9a7a0b1b677c589e9c6a97c8b548aedc65be6eed71e5f6e603aee2dca7fe352a0ee7c041c597131b9e46d867e48e0a3c81628f082bea4868c487e8056734a2a2396e6ee7e730e3dafdd3ee268c422ce667f5ca4e9da3093eb1d3fc8d504691a1a0c5c7b12471ccb63a64222cee4e4e1f212a44ea1446c0dc03696003c7a62a8e4ad0627d7f55c638c775180c4cbf9ed92ac46dd54210a0212e0f88a7cdd5a87c12199fe0bd04f6524fb0a986c96144ebcc6763dfa6e2cf962600a88c010f9a2798849e8e87651cc26d23624bcdca0be537eba155c61dee81dd13a49b7a657527684fa9bb5f8850311cd4c2fceed60b25fab1439a7b5da79af49b410da8329d16fea6d653116432e9cc09ea6d25fe860d30594715512af8f0e160989e17109951d299016c54a3434ee9f9f1f4123155e2c6670b3472acbee2c20c125f26032587857576e4071dea5d5ed935407b599eb9ecc1dc044356862210109d7e875cc0e4febf92fa18d688b4c62b3fda45953b9cd8f78b95573fb94707c30822179ef41d70056ee8f4f67c81a94064c43aaab8b737b6cdc14045ae5ab3280c9a5a6669c43c59956fec9fdbf7c677b6a52e7bde7273f20d778d3cef557a624cb953951b6085384cbc2e0bf93e26779011ee3d7e1b687da115aeae8f0112bf470c0a04c62dbae988d460bf62695f98e9d0d25d72fd96c55105be504e485e0f300e9dbb4ac3643ce9d32390efbc2776ce95ef6a2d0ee9ca9b72ee616dd938f7741236faf8c1dcf3da884e065930052f10d8b6bd384f6428e07afeb2badd27cbe93b9f4d521c993d0895b8dd3223500897b4248966218e3b1cd0e01c3e2b1822352718974fe0d3a30de4788ace096e025c53f00f0b8905735e55667a9c5baa567b4b6701b61b97ee1a84b19624432d7555ad0187e149594ec00ea9b149b7784d9a8d45e29b2fa512fee6bb75c14bb65f85a07daaf9c219813503afb6d7e27e541df8168d6c2e6739ae9ed10eb4d053bc71451abddb3268995e994a95b441b59bb43fda3ad5a4ad0eaf568f746a55c1bbf6da3bf1e79732e1da81aecb523032cb62b4496120452dc4dabaab480e216580f47aaf4f9a14d9486c6e2090502f04347c40a3add1d3289f46b8f3406323ada0a367ddcf4a088c5a6f0d9de9156827781be582eea8e341b6271feef992188389966eadedf641818b0cfd36825555b0fb1197858eb75b97d2fa8aa28ad9122837547484d0d7e4effb394261b7d624345caaf4fd12868e919db5c7dd0c656e9fc3ce323d495380a3f2fc00020f15292d7490eaf0198d8f9ab9bae700000000000000000000000000000b10161e242c363d"
    })";

    const auto tx = test::from_json<state::Transaction>(json::json::parse(input));
    EXPECT_EQ(tx.kind, state::Transaction::Kind::eip1559);
    EXPECT_TRUE(tx.data.empty());
    EXPECT_EQ(tx.gas_limit, 0);
    EXPECT_EQ(tx.value, 0);
    EXPECT_EQ(tx.sender, address{});  // TODO: use 0x0_address?
    EXPECT_FALSE(tx.to.has_value());
    EXPECT_EQ(tx.max_gas_price, 0);
    EXPECT_EQ(tx.max_priority_gas_price, 0);
    ASSERT_EQ(tx.access_list.size(), 2);
    EXPECT_EQ(tx.access_list[0].first, 0xac01_address);
    EXPECT_EQ(tx.access_list[0].second.size(), 0);
    EXPECT_EQ(tx.access_list[1].first, 0xac02_address);
    EXPECT_EQ(tx.access_list[1].second, (std::vector{0xfe_bytes32, 0x00_bytes32}));
    EXPECT_EQ(tx.nonce, 0);
    EXPECT_EQ(tx.public_key, evmc::from_hex("b543b479d32596ff68142e1b094d6c5bb163637cdb1a7823545bbb247216c3eb88b3cc84994aecd8b2efca728e5b7d230aeab46f170fd728959fe12adaa224db67821612405e10f3ffd7ca17cbe6d334603df756982676098c4b312043c28e9ac4333c6adca787b626df488a6073e625ec15b43ad996540ff4acbc0399f86c3b71db66c34b418f88649a15998cdf66d2df70ec147b7806fa2af6e474a17fdf4fbfb9770fe667639cce85afe43af7921a25c47b4a90f681e2014444d2d1dd72e8425a3212dea2e32027c12d04f694fd760c3807296604d8e75bfc391227a07d8e94268bb05fdc6d60c2ec5295148fa440fa519199e8d71cef5d6273f41c6b97b45a78eea4b95ec1be66f68333a8aafb9a54afae1d2df212f0242a91fa3f7a56e41cceb5371e0e54e54e91e3a845ed4002b37d1b7fc9a38fa519403d5777ebeff4e670db5b5756d4528891bbd1633ea971e5abd94fd3952aa16a93ccac79ed0b7a3bfe61b9c8556540665d3f7671bab015a9558b30c16c664637e8f597f6f5f12438bddd3a6a8425c1d43e4f6284f06fc1fecd08e409d43e7f27bd7e80ced2d20a51de41e3d16c772b417a76e6a70bff7e7d77befa243a669ce8ff11c925f1f892cb77af590861983bfa5270dd0960cad197fb903b71cae817352bf9345cf6f1d764a66c5921f8fac3c85c03b32920ea152664d0a6cdc6ce1f972341bddcc6c5f42cee426c40957e2333cedff343f2be9a351b89cd7dc561eec8ae89f7e470d5248660c419dab6958bec40c7c660ec10ee2cd6b45f14e66bcc171d53b973191bed67d3a6dccd74658a483afb735a86a0c554aeb9ada238075c1804ac11930c268930d8bd9e43c2e2d961c0133a3e74661761b3020f772a2abdaa897679916c3b03c151224245e310d9be7f8d1720ab98edcfee9b9940e1524a3a31a17cf5a519ca0e798be339780484180d612286f74b6c050fd4b1afc7021fdf631acc8ba06fd203f149af1c3fe975b0a8118e23c888fc21a60b91acbc420cde6485291cc7d28a0cfcb24efd3458cef7a676dfa10f3d83decb681d48887d7bb49da95fa4f37eca3ffba930421924a20dcc5c3e18a4bac0ffa63d33d62bb2a35a42bab8daf98fab963d1973de9eca38a40e13afc860c06ab8f5e1d20204167871ceb7205530e76720613b009465bb96d6d0554d7f5cbb278fa43e27435a4900464527d42b5960554cc1de5c65cce01532e389fc8eef02f82310ae0965b005f408ce5869b12760660f3da490d9df0477f9afddc03385860014fb921e623ff675dfd9000ad648ccd07eaaeff6ad640c71ad1e23b4bebb16c4aad8a59c4601fc92b70e7269cc9526226c77ed430827efb0fc8ab78e6f16005a138635ad39d365571195a5429a8998a90309ce489186c2cb902ef7a6982bc4b2693abb911d75643877361189cb0d72c08b5eb8c820589cf4e5fe4d46c8721d6a021be1765b2d6c49718a87a03e675d108af6fd9b48f5abca6d7409b1fee92cb5145b9b76d669fce00f9ed6a1047f722b5b4ebfc80f3297ea615bd64ecf51b8777b3a67676d7c48e842bf80f7b84fe3932e58965aff87506739d8bce9792c86c78d43feb83c75008962cc9f4a2e9a52cb94745096cde33f60ad603646f29e317c0ff78c0a3ea200f665aa7c7a4faf338cead6a8ed91b87762cacfd49108ce5c1ec5719cec1cedfbfab64e2aaeb39eecdfae2a3a68df4ea4789c11d4f14fdb034c45c6edecb250cf61c84636ed220289ca958790acb106327705bef2f5cb4f5dd15ae03ed74ef55fffd24d2d8fdd8ef59d990ccf0a418afd23668108e926489145cd6a3e976094a6815962b0a8d45d4cee03ee53fd57e929248e1b6f077b16b6cd5e3e0e08f94bd87df1c360af983c995c126acc3ce00cb19d2dd673e0568dd014713c54d764b6f200a7efada394a44236b765d76261b07d69b76c6427a4433c4617b1503888d88c360636d8090b6dbd5cd2b8c9d83ed82180a150c663ea84d6cfcbad3d52a8b95854baaca3139c8ba52e4a2f6b5589ec77a6382eb502042687f4787b5daa8c6c48bc1d34dbb98a052e52b92a5d2fb5d3dfa0e590c187d93724d497cda403f574b70b1668e3ee2e86a6875135b4bec11a83d853ccebab523360de8cc0fef2594526a81643cef955d78846a7eb8db22b9b225c631d138c3d30cc95b8dea54385d6074a90db216ad07687b1d2353a9e657e61e09a5820cbc1aac4dc03725c60fd48f27b6f0f5420811b30e3bf3b194187cf65ace99d07f54e5b06b43554d63095ec6c3ba13bdcc115155614c7d27ba1940841435111d353251c90bc008e7138e0101b576a2bd60b5e14b4a9cfb51c06dc28681a6afd62c791309e618bfaebebdd59673cf0f5b5aa683816425c0bd1a36bf6f2e74e56db16d8bacd07c851ff6f83f59f38e7aad7479710327487bf176c097ba075191dc67fbdc058ef145a63a5e9f7bdf4904d82ccdb1948790ce99d0144aa12994dc4caee920a2dd5c2bb2c6159374f2ad102d640b7ee7fd94f87807b0eb17d5a676f30b6891aac832b3a541c803711b443dbee27c781471223e5a537312b2e789759bd914c0449d47e42f2690b50762ac4881344e55963a5c77234ef825889de8aadb45d8e9be4977f5868eda16a7744c4c7ade92c804157149005d2b6fb74f730d1695831b7a18c89e87bc2068eb943fa5612e6d130ada284c160d29d2a17ae60df3e8edda822f5c9cda318b51dd65d398d06e58a43ed2b8ff74aa9ab9aaf9c3e8765ba0a374dec4408baabe153a22971407de08ef7d10d20ae6318555f78af959d9a79e0ccf07f250e0f1ff0d900811f1f8fa695c8daace0bb2dbb44f4499e4be4afa47a0c3cdf89aca059a7b4851fd51713c50ba353b7ea9541057270c04c6b9adce2db02f2bade95f34c1b2e0045ac583b6526920031de3ab9bbea36e5ef91a8a012f62ee4803ccd168488d8490467838524f061d40416c4646f81e375937d90eb75d6ef7c36681023191487154e0c25374f8fd3a5d1891fe76c2201d29e6f6bcdd969bebc5512f84e52164fa1694dbce1bd034e5fcaef6ba96ec8945c49099d9dfc61f4d6f8b1ce22f0843ef649b09b67f670d029716855e4aa3f82651ddcce85b765a04eebe30cc8eebf85e69658d5dc19f705c27c989015ecf774b147059c8405c1bae15bd2c7b4a3a7bebed8729daa7f962a75708107e2445f975c3075eecb05439dc4b66b4cd8bf57392bf7be31682ae214049536971ddf7eb8e5b62d359b4c8097333b6ac423ca35dbcc52daedbcb9dc4d8e811e6c281794bfd676e78e675dca6ddfc1da8c05d54d990aea0e7050b75dc57473bc6ca0c6bd9d018a0f3d406816b89e90eb17951034da9f68dfb2736b0c42f4f98ad2301288436dd21c944485e8e084e0408e84e1946e67230730c6af3620f64475dd62fe614fd01a18952d8b396676f747107c467d37b12be91fe164ae083e5ce12f5e8c2a7bccea9f75ff8ea40cc2f8a4fa521fcd92adc7e5b1187ce7e233d7e98c8782b30ebd9ef9c2f15feb6373751accb6eba57b1ead3af4bc5a2b2b4acccaba442fbfbde89ac8ea1e5f9bbb5c122ce22a53371250a58e5d7a735419cc32a8ab047cf097253f8a84dfe64c208b0b0c80e5930cb26ce93f375eb3c1db4bb7"));
    EXPECT_EQ(tx.signature,
        evmc::from_hex(
            "131cea321925fbfd34681919d181826208ee5e27280a0882101b8072cf371aab14330a0fa303e2cbbc5ab5"
            "bd5f54e23077563a75f4f261e05ae6a7d55a92e8fe0b8c899d8b5145723c23e3d606f7797099866e0f4075"
            "dcd0f68c5a86295a4d1414acf5a14d22392477a96e12b4ac9f554f522381d9a641d888f1f4d0bb18092adb"
            "ac3578c737233f9c39ff1ee7a23449d6b5f43e30dad56d3ac83a324fef6335faaab40ffaab92c1c9575d28"
            "645c2681031ca51141ee13d9dbf79fa0adbcb04b582fc6a41f6e9d13a1c5ebd89430c67e0cebd70905420b"
            "e18465e6db742b117fb39b29613b7f29bb028535cfdc3e9fd2d498ce3c03947a1c28c1efcba723aad5599f"
            "6b9a1800cf47238ebf0c4ba4c0fc525302b16ada42d13511c4d231beca31ac680a8ee2ece5714705451160"
            "e3f8a9d2c2b8d1e18fdf2a9b38a0ef4bc1bb476fcce8a06e5d5f3f0f5f1e629b47670b093955fd2750ce3f"
            "d9b331b4f009d62fc07f86b18e6ecbdfc742f348836cd7abcdcf48f2c75960d01617007b4ac89ad220eefe"
            "9f933acfd1677513c042ba32e4d7bb1a4cd7d453b37e7a36770dac2f0e20a45ba8ca253d6bc87599e9b8c2"
            "0879d6bbd30e116a219661cabe9e219abbbb6972bf9374817f4bc73528b0ae9831545571f3645dd9b210b5"
            "858570951cd32e3d81fe083073352d962d0c6ac212587fc99ad76a7dc15679e236f29cf33c38d7ae6ec364"
            "688f53f0a0d93875b6b8f969f5123579ca0311ff521a91f4e3010fc6863adc4c8056f41bd8441f38e6d197"
            "acf06ba452ddc2ed17156725a9db5db8aee34144af0f31bcdc8b15af8190351fa68656ff5f6cf0bf453452"
            "39fb0097cccca7536b81e08fede797118a5e10e1427f06e95e70a97b426bc2b1326eed13a07877958d2586"
            "d42552b41ecf1fcad21f59dc9c4d48837eb6fd0f9f20e3cda3f427f9d371abc99706596680c1bf068c238c"
            "361cb85f31c391662f9cbf6404144a07fae246da521d98fe21c039677f87f32357aa727ca8e5811f7a4af0"
            "c28eb800e734ec42332092133a77ad5a757f0f73ad8d0df0c07ecaa09dd78349b500c6bff466750107a1f8"
            "b9f3c8ff251b7026b1de0fa7a57806f447f5817f670aad99d89fe88e997f4f1c3f4a474bddfc424245a604"
            "2f923cad0d8b7a3ebdf005ac3138f7edfeab5b7d6a642f4b41d2e2b0b342bbdcb677d1440313fcd003e3cf"
            "6a18be70172f0f6ee0a5545a5dbd1902d0d9cadfb7e74cb4946364a81bf8d8440fb006b3ee0ccfead39209"
            "c4db55bcd339ce6b97d9016d30aa82118ba1a169daae06174c9f375fb02c6857925bd112c08307a463c46d"
            "94a74c6f61e8adc2eb3cc9fbdd6177ce0fce161aca2c23d424e1a3d8286f524bb73f5c4268dc3b10477758"
            "743780eedc9ef0aca5f24f1782dfb771713b8a04100681d8bbda636fcbb4cbb4eb38b84b9d038f5af5815d"
            "c0caa4085f0e75f06b4a23fcea2bc9673be28ff4f08f3b8f1da7d9a1b766e7858b7c9d07ac793395e240ec"
            "9479c9b6d1be8fdcfa034d596c21cca6a654ab8dbb86f4fa96cbb638ac79fcfb52f1758b2e25fa713e9d00"
            "cb1d049e05beb06a5fd7a41546c27f48e0d570361b3583ab0e3a8f45d66d26fb9ae45e1c2f5e21ecc6fdbe"
            "1a8887447407e6e846bdcc0c4503bdc4d1251413af44c4211ba2693f7739e608d4fae117298d5b54bdbe49"
            "d956854e652ac4fca43e754c5b9f7f6c07c8e591770fe5ec88250ec08a5c2aaed6ab0b547e7420522146a6"
            "08488120da81f12a6812b6811224d8dcfddc3c2029cfc57f38d6c26b55006ae38332413a30981871123131"
            "dc9f59726abdb9ddcabb45cb681f2a9ec768dab64d0e91950b5a4402fb84600dfcea66ff9579a89b2310ab"
            "84940c7b4cafafe4b5401fb6b96d33595e3b2fc6d77caa4eb5acdc4e60ee2c825bdf9dd042ddb58ba228f0"
            "ffed3164fe5be4bf4c4c278b7d8002fba4a51ee116b16319da4e580bcf930bb354639554ec469066ac4b01"
            "d2fca1273c006bd65d9be494638e26e93871f6053cccdbc42450693d41d26baca77f2da4d7dc94f089fedb"
            "29da25968dab109a634d010dfe91bb04c7047151485412ff1a84cd7daa44c830b9767dac473b7d0f1da7e6"
            "2c53c8c5ef41cdabb4b4a55cf0a37e6a8ca522d4f0ca6cec0ca4d154684a9123f4cf2573a013abf04aec34"
            "3e79458b3510377a10d6a0b89a8f0abb52f1a77013357faa9e3ec2086c2dcc9299e06993590bcf3ee43d4f"
            "5a0a56830acb876af929ff56ae63120e7e33d040e4697ed3819d17878badcfef17ce5fad90c17e29448665"
            "ca0dcafcc891f696a50402eb9c96c517e5eb7e796b05db330d79e9e74ef8e14d22174607258ed4c704c11a"
            "c617b02cc4b628d7911acb7ab67def265a0cfc02a6b5e2b73922fc8be941d31cc192a113f70f803b6467cf"
            "0ce3b96c3cd6d652c6d11f98af06a12cd993b80daca08d16bd71b265218b62af36cf1ab5d975a13743f3ac"
            "ee638203cea0d1e54875b396d950036f3209620a487306589f9e4bf5ac88f3926fe93b8465ff50689f26a3"
            "58d9461544a0c5484750333b75a2b8d471f962b1a7ae288372f06bfcc75b35721d551018b1604234f97a04"
            "d9dcc1dfee735857074ce8c2afed249add41226f0fa401bfd6d80b97d13648c62a50240a39bdcc0c5c6537"
            "01bebee3fc0bee0650f4f27fb0701933b56766c4de3bce8750fd88fadf2bccb6c2e520422431474371e949"
            "091b36e89fddc0c63bcd95602f423e91eb7dcd4735ac41b47aa65b2ebdca4f7905c9282efd26ae7abaeccf"
            "329833b1135f8ad520c9ec36eb919e3793ee40ee6d393957aee78ed6afde608c43c985608c40a6e6ebc91c"
            "5b3ec7788ea17e30ba5752dbc22944e3a63615c42654f88f7f559b8dfc3addc60a94e3f22d023cdf9d67d3"
            "e0927e43f7151e335ed488716b34e22c67cb4ce5b2d8da9163d5ed5e582fcb05886ebd01f4f353bfe794bf"
            "a4b9f55ea79cc865f67a5d1a2536da33efba5fefcb368ae071ddd4ff58b201011e7a631d272adc15fab9ed"
            "46c5b8f5c0aad75f550327f738222713f9a752f754ee1bfa18b671c741d3ec6492a8525aea8428754b51b1"
            "90cd4d290f8b1d470cf4b75ca541e8efe67ea38166c307958822a48e79c9cb7c83112009f47686d11bdc25"
            "bc3d1519e0e452967ccef3cf47669584088849de602afbec9c7d64951d6a4ad92a49d981b67d3a992bf83a"
            "9bb021408a2255186d9b7c229a51b505a5f8eb2603fd8822a2de8ca3c583bf9f373614ee905a6ebe2b478d"
            "0f07c1b790bc8c1e5db7f81511a12878dd97c242e9dffe8dfd087e17dfbe885132a4399136ee663f4d94a2"
            "e58dac1b8abfeaef38d7404802a72c2ddfc36591c27c5b369ef6174fa07e483a35d00101479e350e047f8a"
            "dfc49e28862ea360dacaa9f52b8b0f5e2816bf80ad62906830f57d59357ffe7326e8f6e2185c026634e673"
            "46e801419473de2934f555b2061f9b9b459e71bd704c9156e0193fb12a6b8fd49719b21249ab8953ce04df"
            "037da1655c0ac0c3a25fec70c90fd18bf51946c18147f9e6a3287895f4d6183012701ded7de25ee3616b72"
            "37d910d42b065bc5e554b51d07f3e98c240e0a6c019c74075996ab23ad217daebd1f5c0bb402f597de5159"
            "235bc6589b76b94d7532b86b3d6728386ddffefbae921be8d05074011a75b63640829e68e2d4b70ecbac16"
            "37e4a9a77ee9ab8179d35ca0256b357a00dd63c792a1ad5ca259956a1b1a51f7819793b68443e2b28550e3"
            "3a07d360b214581cbc367a87512d1dd758ce2e9f6196046412c942613b5ef4dce7c7fe07bbdf425eb0afab"
            "16192561bab9e67b06f47c461a9f5b3baae0f27ddf3a9812836e9debb961ebdb4cc377edfbc05a610ce8f7"
            "ce9f12e3c4abb6ca51b96323b204b48dfa8abeea27785c273a9d700c8f8fca96e1d1a2799fb23a045ffd58"
            "ca485bfc9d930ccee781beac3560f45909414806faf0bb8fc6657384c13fcd5e9da7b79834292dfd641869"
            "0b03cb6718b7c9637fa918f6a9a19d3dfe3a76d96bb3c0db0fd6751b9a394b55460042036e0b85c1e135a2"
            "a9d37dd871afa405e4ae5827c47e657d9694f51bee74768b03ee9e7b8731919e962cfaec19439e5eaa40f9"
            "2e7094de8ab6c0a91b451b6d0cbefa9e44a471ca1549c78e66a2c622dc07294fa908e0e64e100c3550edb8"
            "c31f302f81aa8e154e9f666cfe904145a9c7ecdb3765f60c7ba06360df5639ef684653a5f90bb47510d035"
            "7cd5f0de0ed0419477b6af059f01948954b3844627853bb23fb76861fed81a09a03ce4a4c512dd91bba59e"
            "72aef3936290979d93222667ac31df7514e5eac1b53efdda607215af47a813af08588d28cd9c2ef93985b4"
            "7bd6e833ac07de0af0aeeb92ad36af2c05f47d6a31ee75e19b841ffc79ae865edddd97865b7f661aed1579"
            "22f93903884cc6d489d8f1a6160c31509b9250c481c9d9ed99778e90a38969549c563820a13ebb5dd0184d"
            "fc58d28614ce1522bf4e99724e9452f64592ab01424035581780653d5093468c555dfc52ac86e43644e0f3"
            "f89d06c7cc0d6566bde0b2fdb896665425e5cc80bd4795247217a08f16fdf9e522ff7868b01598e0b8a41d"
            "a2221fdb646409eb102107a20d5ea06ea3b3c0139d02480be6e42cc00b2a32ccdd0eeeaea90e1dcbef4bbd"
            "7b7100a74486354ce5baa8a230ec7c58e1f9269124057c491c48a02159cf3f37375f8bfaeb4eafd6fa9d82"
            "09dbcba61c8d189171c313ac75ed7d69f5b16ee60ee7cfc0f98d76796643d2bf4555db2b3604914e06b2c5"
            "5dc62607bf622956705762005ceeed11599871f89cc7e2d4d86231bec5d423382e77f9707c41d6062efc56"
            "512e6339e34b64152393e8d42391b6311423f8730a85261375e5fcd5cff5f26abb6faaa75e8f8167cc6374"
            "f8f3fbe10b688f292fb4cc12c93f678b8f5110cd8baaae7e8ba05a11f8b469adb853f7d20fe2d6b8f0980e"
            "83ec83ae042ea10a3cf6a5dafe4015ed86e0a484350dc433f7870f8b3069dcbeeefb4c00b9abfbfe0a9741"
            "9fee479985525b018c71d686ea99adf70afabe29d392e5fab7535aaaa05cf362e9797d5f4269b16e7c9e9a"
            "6b45c48a29de93a5c44e00efc4bae4c730e77810d00db122b86ea9997d9a7a0b1b677c589e9c6a97c8b548"
            "aedc65be6eed71e5f6e603aee2dca7fe352a0ee7c041c597131b9e46d867e48e0a3c81628f082bea4868c4"
            "87e8056734a2a2396e6ee7e730e3dafdd3ee268c422ce667f5ca4e9da3093eb1d3fc8d504691a1a0c5c7b1"
            "2471ccb63a64222cee4e4e1f212a44ea1446c0dc03696003c7a62a8e4ad0627d7f55c638c775180c4cbf9e"
            "d92ac46dd54210a0212e0f88a7cdd5a87c12199fe0bd04f6524fb0a986c96144ebcc6763dfa6e2cf962600"
            "a88c010f9a2798849e8e87651cc26d23624bcdca0be537eba155c61dee81dd13a49b7a657527684fa9bb5f"
            "8850311cd4c2fceed60b25fab1439a7b5da79af49b410da8329d16fea6d653116432e9cc09ea6d25fe860d"
            "30594715512af8f0e160989e17109951d299016c54a3434ee9f9f1f4123155e2c6670b3472acbee2c20c12"
            "5f26032587857576e4071dea5d5ed935407b599eb9ecc1dc044356862210109d7e875cc0e4febf92fa18d6"
            "88b4c62b3fda45953b9cd8f78b95573fb94707c30822179ef41d70056ee8f4f67c81a94064c43aaab8b737"
            "b6cdc14045ae5ab3280c9a5a6669c43c59956fec9fdbf7c677b6a52e7bde7273f20d778d3cef557a624cb9"
            "53951b6085384cbc2e0bf93e26779011ee3d7e1b687da115aeae8f0112bf470c0a04c62dbae988d460bf62"
            "695f98e9d0d25d72fd96c55105be504e485e0f300e9dbb4ac3643ce9d32390efbc2776ce95ef6a2d0ee9ca"
            "9b72ee616dd938f7741236faf8c1dcf3da884e065930052f10d8b6bd384f6428e07afeb2badd27cbe93b9f"
            "4d521c993d0895b8dd3223500897b4248966218e3b1cd0e01c3e2b1822352718974fe0d3a30de4788ace09"
            "6e025c53f00f0b8905735e55667a9c5baa567b4b6701b61b97ee1a84b19624432d7555ad0187e149594ec0"
            "0ea9b149b7784d9a8d45e29b2fa512fee6bb75c14bb65f85a07daaf9c219813503afb6d7e27e541df8168d"
            "6c2e6739ae9ed10eb4d053bc71451abddb3268995e994a95b441b59bb43fda3ad5a4ad0eaf568f746a55c1"
            "bbf6da3bf1e79732e1da81aecb523032cb62b4496120452dc4dabaab480e216580f47aaf4f9a14d9486c6e"
            "2090502f04347c40a3add1d3289f46b8f3406323ada0a367ddcf4a088c5a6f0d9de9156827781be582eea8"
            "e341b6271feef992188389966eadedf641818b0cfd36825555b0fb1197858eb75b97d2fa8aa28ad9122837"
            "547484d0d7e4effb394261b7d624345caaf4fd12868e919db5c7dd0c656e9fc3ce323d495380a3f2fc0002"
            "0f15292d7490eaf0198d8f9ab9bae700000000000000000000000000000b10161e242c363d"));
}

TEST(statetest_loader, invalid_tx_type)
{
    {
        constexpr std::string_view input = R"({
                "input": "",
                "gas": "0",
                "type": "0",
                "value": "0",
                "sender": "",
                "maxFeePerGas": "0",
                "maxPriorityFeePerGas": "0",
                "to": "",
                "accessList": [
                    {"address": "ac01", "storageKeys": []},
                    {"address": "ac02", "storageKeys": ["fe", "00"]}
                ],
                "nonce": "0",
                "publicKey": "0xb543b479d32596ff68142e1b094d6c5bb163637cdb1a7823545bbb247216c3eb88b3cc84994aecd8b2efca728e5b7d230aeab46f170fd728959fe12adaa224db67821612405e10f3ffd7ca17cbe6d334603df756982676098c4b312043c28e9ac4333c6adca787b626df488a6073e625ec15b43ad996540ff4acbc0399f86c3b71db66c34b418f88649a15998cdf66d2df70ec147b7806fa2af6e474a17fdf4fbfb9770fe667639cce85afe43af7921a25c47b4a90f681e2014444d2d1dd72e8425a3212dea2e32027c12d04f694fd760c3807296604d8e75bfc391227a07d8e94268bb05fdc6d60c2ec5295148fa440fa519199e8d71cef5d6273f41c6b97b45a78eea4b95ec1be66f68333a8aafb9a54afae1d2df212f0242a91fa3f7a56e41cceb5371e0e54e54e91e3a845ed4002b37d1b7fc9a38fa519403d5777ebeff4e670db5b5756d4528891bbd1633ea971e5abd94fd3952aa16a93ccac79ed0b7a3bfe61b9c8556540665d3f7671bab015a9558b30c16c664637e8f597f6f5f12438bddd3a6a8425c1d43e4f6284f06fc1fecd08e409d43e7f27bd7e80ced2d20a51de41e3d16c772b417a76e6a70bff7e7d77befa243a669ce8ff11c925f1f892cb77af590861983bfa5270dd0960cad197fb903b71cae817352bf9345cf6f1d764a66c5921f8fac3c85c03b32920ea152664d0a6cdc6ce1f972341bddcc6c5f42cee426c40957e2333cedff343f2be9a351b89cd7dc561eec8ae89f7e470d5248660c419dab6958bec40c7c660ec10ee2cd6b45f14e66bcc171d53b973191bed67d3a6dccd74658a483afb735a86a0c554aeb9ada238075c1804ac11930c268930d8bd9e43c2e2d961c0133a3e74661761b3020f772a2abdaa897679916c3b03c151224245e310d9be7f8d1720ab98edcfee9b9940e1524a3a31a17cf5a519ca0e798be339780484180d612286f74b6c050fd4b1afc7021fdf631acc8ba06fd203f149af1c3fe975b0a8118e23c888fc21a60b91acbc420cde6485291cc7d28a0cfcb24efd3458cef7a676dfa10f3d83decb681d48887d7bb49da95fa4f37eca3ffba930421924a20dcc5c3e18a4bac0ffa63d33d62bb2a35a42bab8daf98fab963d1973de9eca38a40e13afc860c06ab8f5e1d20204167871ceb7205530e76720613b009465bb96d6d0554d7f5cbb278fa43e27435a4900464527d42b5960554cc1de5c65cce01532e389fc8eef02f82310ae0965b005f408ce5869b12760660f3da490d9df0477f9afddc03385860014fb921e623ff675dfd9000ad648ccd07eaaeff6ad640c71ad1e23b4bebb16c4aad8a59c4601fc92b70e7269cc9526226c77ed430827efb0fc8ab78e6f16005a138635ad39d365571195a5429a8998a90309ce489186c2cb902ef7a6982bc4b2693abb911d75643877361189cb0d72c08b5eb8c820589cf4e5fe4d46c8721d6a021be1765b2d6c49718a87a03e675d108af6fd9b48f5abca6d7409b1fee92cb5145b9b76d669fce00f9ed6a1047f722b5b4ebfc80f3297ea615bd64ecf51b8777b3a67676d7c48e842bf80f7b84fe3932e58965aff87506739d8bce9792c86c78d43feb83c75008962cc9f4a2e9a52cb94745096cde33f60ad603646f29e317c0ff78c0a3ea200f665aa7c7a4faf338cead6a8ed91b87762cacfd49108ce5c1ec5719cec1cedfbfab64e2aaeb39eecdfae2a3a68df4ea4789c11d4f14fdb034c45c6edecb250cf61c84636ed220289ca958790acb106327705bef2f5cb4f5dd15ae03ed74ef55fffd24d2d8fdd8ef59d990ccf0a418afd23668108e926489145cd6a3e976094a6815962b0a8d45d4cee03ee53fd57e929248e1b6f077b16b6cd5e3e0e08f94bd87df1c360af983c995c126acc3ce00cb19d2dd673e0568dd014713c54d764b6f200a7efada394a44236b765d76261b07d69b76c6427a4433c4617b1503888d88c360636d8090b6dbd5cd2b8c9d83ed82180a150c663ea84d6cfcbad3d52a8b95854baaca3139c8ba52e4a2f6b5589ec77a6382eb502042687f4787b5daa8c6c48bc1d34dbb98a052e52b92a5d2fb5d3dfa0e590c187d93724d497cda403f574b70b1668e3ee2e86a6875135b4bec11a83d853ccebab523360de8cc0fef2594526a81643cef955d78846a7eb8db22b9b225c631d138c3d30cc95b8dea54385d6074a90db216ad07687b1d2353a9e657e61e09a5820cbc1aac4dc03725c60fd48f27b6f0f5420811b30e3bf3b194187cf65ace99d07f54e5b06b43554d63095ec6c3ba13bdcc115155614c7d27ba1940841435111d353251c90bc008e7138e0101b576a2bd60b5e14b4a9cfb51c06dc28681a6afd62c791309e618bfaebebdd59673cf0f5b5aa683816425c0bd1a36bf6f2e74e56db16d8bacd07c851ff6f83f59f38e7aad7479710327487bf176c097ba075191dc67fbdc058ef145a63a5e9f7bdf4904d82ccdb1948790ce99d0144aa12994dc4caee920a2dd5c2bb2c6159374f2ad102d640b7ee7fd94f87807b0eb17d5a676f30b6891aac832b3a541c803711b443dbee27c781471223e5a537312b2e789759bd914c0449d47e42f2690b50762ac4881344e55963a5c77234ef825889de8aadb45d8e9be4977f5868eda16a7744c4c7ade92c804157149005d2b6fb74f730d1695831b7a18c89e87bc2068eb943fa5612e6d130ada284c160d29d2a17ae60df3e8edda822f5c9cda318b51dd65d398d06e58a43ed2b8ff74aa9ab9aaf9c3e8765ba0a374dec4408baabe153a22971407de08ef7d10d20ae6318555f78af959d9a79e0ccf07f250e0f1ff0d900811f1f8fa695c8daace0bb2dbb44f4499e4be4afa47a0c3cdf89aca059a7b4851fd51713c50ba353b7ea9541057270c04c6b9adce2db02f2bade95f34c1b2e0045ac583b6526920031de3ab9bbea36e5ef91a8a012f62ee4803ccd168488d8490467838524f061d40416c4646f81e375937d90eb75d6ef7c36681023191487154e0c25374f8fd3a5d1891fe76c2201d29e6f6bcdd969bebc5512f84e52164fa1694dbce1bd034e5fcaef6ba96ec8945c49099d9dfc61f4d6f8b1ce22f0843ef649b09b67f670d029716855e4aa3f82651ddcce85b765a04eebe30cc8eebf85e69658d5dc19f705c27c989015ecf774b147059c8405c1bae15bd2c7b4a3a7bebed8729daa7f962a75708107e2445f975c3075eecb05439dc4b66b4cd8bf57392bf7be31682ae214049536971ddf7eb8e5b62d359b4c8097333b6ac423ca35dbcc52daedbcb9dc4d8e811e6c281794bfd676e78e675dca6ddfc1da8c05d54d990aea0e7050b75dc57473bc6ca0c6bd9d018a0f3d406816b89e90eb17951034da9f68dfb2736b0c42f4f98ad2301288436dd21c944485e8e084e0408e84e1946e67230730c6af3620f64475dd62fe614fd01a18952d8b396676f747107c467d37b12be91fe164ae083e5ce12f5e8c2a7bccea9f75ff8ea40cc2f8a4fa521fcd92adc7e5b1187ce7e233d7e98c8782b30ebd9ef9c2f15feb6373751accb6eba57b1ead3af4bc5a2b2b4acccaba442fbfbde89ac8ea1e5f9bbb5c122ce22a53371250a58e5d7a735419cc32a8ab047cf097253f8a84dfe64c208b0b0c80e5930cb26ce93f375eb3c1db4bb7",
                "signature": "0x131cea321925fbfd34681919d181826208ee5e27280a0882101b8072cf371aab14330a0fa303e2cbbc5ab5bd5f54e23077563a75f4f261e05ae6a7d55a92e8fe0b8c899d8b5145723c23e3d606f7797099866e0f4075dcd0f68c5a86295a4d1414acf5a14d22392477a96e12b4ac9f554f522381d9a641d888f1f4d0bb18092adbac3578c737233f9c39ff1ee7a23449d6b5f43e30dad56d3ac83a324fef6335faaab40ffaab92c1c9575d28645c2681031ca51141ee13d9dbf79fa0adbcb04b582fc6a41f6e9d13a1c5ebd89430c67e0cebd70905420be18465e6db742b117fb39b29613b7f29bb028535cfdc3e9fd2d498ce3c03947a1c28c1efcba723aad5599f6b9a1800cf47238ebf0c4ba4c0fc525302b16ada42d13511c4d231beca31ac680a8ee2ece5714705451160e3f8a9d2c2b8d1e18fdf2a9b38a0ef4bc1bb476fcce8a06e5d5f3f0f5f1e629b47670b093955fd2750ce3fd9b331b4f009d62fc07f86b18e6ecbdfc742f348836cd7abcdcf48f2c75960d01617007b4ac89ad220eefe9f933acfd1677513c042ba32e4d7bb1a4cd7d453b37e7a36770dac2f0e20a45ba8ca253d6bc87599e9b8c20879d6bbd30e116a219661cabe9e219abbbb6972bf9374817f4bc73528b0ae9831545571f3645dd9b210b5858570951cd32e3d81fe083073352d962d0c6ac212587fc99ad76a7dc15679e236f29cf33c38d7ae6ec364688f53f0a0d93875b6b8f969f5123579ca0311ff521a91f4e3010fc6863adc4c8056f41bd8441f38e6d197acf06ba452ddc2ed17156725a9db5db8aee34144af0f31bcdc8b15af8190351fa68656ff5f6cf0bf45345239fb0097cccca7536b81e08fede797118a5e10e1427f06e95e70a97b426bc2b1326eed13a07877958d2586d42552b41ecf1fcad21f59dc9c4d48837eb6fd0f9f20e3cda3f427f9d371abc99706596680c1bf068c238c361cb85f31c391662f9cbf6404144a07fae246da521d98fe21c039677f87f32357aa727ca8e5811f7a4af0c28eb800e734ec42332092133a77ad5a757f0f73ad8d0df0c07ecaa09dd78349b500c6bff466750107a1f8b9f3c8ff251b7026b1de0fa7a57806f447f5817f670aad99d89fe88e997f4f1c3f4a474bddfc424245a6042f923cad0d8b7a3ebdf005ac3138f7edfeab5b7d6a642f4b41d2e2b0b342bbdcb677d1440313fcd003e3cf6a18be70172f0f6ee0a5545a5dbd1902d0d9cadfb7e74cb4946364a81bf8d8440fb006b3ee0ccfead39209c4db55bcd339ce6b97d9016d30aa82118ba1a169daae06174c9f375fb02c6857925bd112c08307a463c46d94a74c6f61e8adc2eb3cc9fbdd6177ce0fce161aca2c23d424e1a3d8286f524bb73f5c4268dc3b10477758743780eedc9ef0aca5f24f1782dfb771713b8a04100681d8bbda636fcbb4cbb4eb38b84b9d038f5af5815dc0caa4085f0e75f06b4a23fcea2bc9673be28ff4f08f3b8f1da7d9a1b766e7858b7c9d07ac793395e240ec9479c9b6d1be8fdcfa034d596c21cca6a654ab8dbb86f4fa96cbb638ac79fcfb52f1758b2e25fa713e9d00cb1d049e05beb06a5fd7a41546c27f48e0d570361b3583ab0e3a8f45d66d26fb9ae45e1c2f5e21ecc6fdbe1a8887447407e6e846bdcc0c4503bdc4d1251413af44c4211ba2693f7739e608d4fae117298d5b54bdbe49d956854e652ac4fca43e754c5b9f7f6c07c8e591770fe5ec88250ec08a5c2aaed6ab0b547e7420522146a608488120da81f12a6812b6811224d8dcfddc3c2029cfc57f38d6c26b55006ae38332413a30981871123131dc9f59726abdb9ddcabb45cb681f2a9ec768dab64d0e91950b5a4402fb84600dfcea66ff9579a89b2310ab84940c7b4cafafe4b5401fb6b96d33595e3b2fc6d77caa4eb5acdc4e60ee2c825bdf9dd042ddb58ba228f0ffed3164fe5be4bf4c4c278b7d8002fba4a51ee116b16319da4e580bcf930bb354639554ec469066ac4b01d2fca1273c006bd65d9be494638e26e93871f6053cccdbc42450693d41d26baca77f2da4d7dc94f089fedb29da25968dab109a634d010dfe91bb04c7047151485412ff1a84cd7daa44c830b9767dac473b7d0f1da7e62c53c8c5ef41cdabb4b4a55cf0a37e6a8ca522d4f0ca6cec0ca4d154684a9123f4cf2573a013abf04aec343e79458b3510377a10d6a0b89a8f0abb52f1a77013357faa9e3ec2086c2dcc9299e06993590bcf3ee43d4f5a0a56830acb876af929ff56ae63120e7e33d040e4697ed3819d17878badcfef17ce5fad90c17e29448665ca0dcafcc891f696a50402eb9c96c517e5eb7e796b05db330d79e9e74ef8e14d22174607258ed4c704c11ac617b02cc4b628d7911acb7ab67def265a0cfc02a6b5e2b73922fc8be941d31cc192a113f70f803b6467cf0ce3b96c3cd6d652c6d11f98af06a12cd993b80daca08d16bd71b265218b62af36cf1ab5d975a13743f3acee638203cea0d1e54875b396d950036f3209620a487306589f9e4bf5ac88f3926fe93b8465ff50689f26a358d9461544a0c5484750333b75a2b8d471f962b1a7ae288372f06bfcc75b35721d551018b1604234f97a04d9dcc1dfee735857074ce8c2afed249add41226f0fa401bfd6d80b97d13648c62a50240a39bdcc0c5c653701bebee3fc0bee0650f4f27fb0701933b56766c4de3bce8750fd88fadf2bccb6c2e520422431474371e949091b36e89fddc0c63bcd95602f423e91eb7dcd4735ac41b47aa65b2ebdca4f7905c9282efd26ae7abaeccf329833b1135f8ad520c9ec36eb919e3793ee40ee6d393957aee78ed6afde608c43c985608c40a6e6ebc91c5b3ec7788ea17e30ba5752dbc22944e3a63615c42654f88f7f559b8dfc3addc60a94e3f22d023cdf9d67d3e0927e43f7151e335ed488716b34e22c67cb4ce5b2d8da9163d5ed5e582fcb05886ebd01f4f353bfe794bfa4b9f55ea79cc865f67a5d1a2536da33efba5fefcb368ae071ddd4ff58b201011e7a631d272adc15fab9ed46c5b8f5c0aad75f550327f738222713f9a752f754ee1bfa18b671c741d3ec6492a8525aea8428754b51b190cd4d290f8b1d470cf4b75ca541e8efe67ea38166c307958822a48e79c9cb7c83112009f47686d11bdc25bc3d1519e0e452967ccef3cf47669584088849de602afbec9c7d64951d6a4ad92a49d981b67d3a992bf83a9bb021408a2255186d9b7c229a51b505a5f8eb2603fd8822a2de8ca3c583bf9f373614ee905a6ebe2b478d0f07c1b790bc8c1e5db7f81511a12878dd97c242e9dffe8dfd087e17dfbe885132a4399136ee663f4d94a2e58dac1b8abfeaef38d7404802a72c2ddfc36591c27c5b369ef6174fa07e483a35d00101479e350e047f8adfc49e28862ea360dacaa9f52b8b0f5e2816bf80ad62906830f57d59357ffe7326e8f6e2185c026634e67346e801419473de2934f555b2061f9b9b459e71bd704c9156e0193fb12a6b8fd49719b21249ab8953ce04df037da1655c0ac0c3a25fec70c90fd18bf51946c18147f9e6a3287895f4d6183012701ded7de25ee3616b7237d910d42b065bc5e554b51d07f3e98c240e0a6c019c74075996ab23ad217daebd1f5c0bb402f597de5159235bc6589b76b94d7532b86b3d6728386ddffefbae921be8d05074011a75b63640829e68e2d4b70ecbac1637e4a9a77ee9ab8179d35ca0256b357a00dd63c792a1ad5ca259956a1b1a51f7819793b68443e2b28550e33a07d360b214581cbc367a87512d1dd758ce2e9f6196046412c942613b5ef4dce7c7fe07bbdf425eb0afab16192561bab9e67b06f47c461a9f5b3baae0f27ddf3a9812836e9debb961ebdb4cc377edfbc05a610ce8f7ce9f12e3c4abb6ca51b96323b204b48dfa8abeea27785c273a9d700c8f8fca96e1d1a2799fb23a045ffd58ca485bfc9d930ccee781beac3560f45909414806faf0bb8fc6657384c13fcd5e9da7b79834292dfd6418690b03cb6718b7c9637fa918f6a9a19d3dfe3a76d96bb3c0db0fd6751b9a394b55460042036e0b85c1e135a2a9d37dd871afa405e4ae5827c47e657d9694f51bee74768b03ee9e7b8731919e962cfaec19439e5eaa40f92e7094de8ab6c0a91b451b6d0cbefa9e44a471ca1549c78e66a2c622dc07294fa908e0e64e100c3550edb8c31f302f81aa8e154e9f666cfe904145a9c7ecdb3765f60c7ba06360df5639ef684653a5f90bb47510d0357cd5f0de0ed0419477b6af059f01948954b3844627853bb23fb76861fed81a09a03ce4a4c512dd91bba59e72aef3936290979d93222667ac31df7514e5eac1b53efdda607215af47a813af08588d28cd9c2ef93985b47bd6e833ac07de0af0aeeb92ad36af2c05f47d6a31ee75e19b841ffc79ae865edddd97865b7f661aed157922f93903884cc6d489d8f1a6160c31509b9250c481c9d9ed99778e90a38969549c563820a13ebb5dd0184dfc58d28614ce1522bf4e99724e9452f64592ab01424035581780653d5093468c555dfc52ac86e43644e0f3f89d06c7cc0d6566bde0b2fdb896665425e5cc80bd4795247217a08f16fdf9e522ff7868b01598e0b8a41da2221fdb646409eb102107a20d5ea06ea3b3c0139d02480be6e42cc00b2a32ccdd0eeeaea90e1dcbef4bbd7b7100a74486354ce5baa8a230ec7c58e1f9269124057c491c48a02159cf3f37375f8bfaeb4eafd6fa9d8209dbcba61c8d189171c313ac75ed7d69f5b16ee60ee7cfc0f98d76796643d2bf4555db2b3604914e06b2c55dc62607bf622956705762005ceeed11599871f89cc7e2d4d86231bec5d423382e77f9707c41d6062efc56512e6339e34b64152393e8d42391b6311423f8730a85261375e5fcd5cff5f26abb6faaa75e8f8167cc6374f8f3fbe10b688f292fb4cc12c93f678b8f5110cd8baaae7e8ba05a11f8b469adb853f7d20fe2d6b8f0980e83ec83ae042ea10a3cf6a5dafe4015ed86e0a484350dc433f7870f8b3069dcbeeefb4c00b9abfbfe0a97419fee479985525b018c71d686ea99adf70afabe29d392e5fab7535aaaa05cf362e9797d5f4269b16e7c9e9a6b45c48a29de93a5c44e00efc4bae4c730e77810d00db122b86ea9997d9a7a0b1b677c589e9c6a97c8b548aedc65be6eed71e5f6e603aee2dca7fe352a0ee7c041c597131b9e46d867e48e0a3c81628f082bea4868c487e8056734a2a2396e6ee7e730e3dafdd3ee268c422ce667f5ca4e9da3093eb1d3fc8d504691a1a0c5c7b12471ccb63a64222cee4e4e1f212a44ea1446c0dc03696003c7a62a8e4ad0627d7f55c638c775180c4cbf9ed92ac46dd54210a0212e0f88a7cdd5a87c12199fe0bd04f6524fb0a986c96144ebcc6763dfa6e2cf962600a88c010f9a2798849e8e87651cc26d23624bcdca0be537eba155c61dee81dd13a49b7a657527684fa9bb5f8850311cd4c2fceed60b25fab1439a7b5da79af49b410da8329d16fea6d653116432e9cc09ea6d25fe860d30594715512af8f0e160989e17109951d299016c54a3434ee9f9f1f4123155e2c6670b3472acbee2c20c125f26032587857576e4071dea5d5ed935407b599eb9ecc1dc044356862210109d7e875cc0e4febf92fa18d688b4c62b3fda45953b9cd8f78b95573fb94707c30822179ef41d70056ee8f4f67c81a94064c43aaab8b737b6cdc14045ae5ab3280c9a5a6669c43c59956fec9fdbf7c677b6a52e7bde7273f20d778d3cef557a624cb953951b6085384cbc2e0bf93e26779011ee3d7e1b687da115aeae8f0112bf470c0a04c62dbae988d460bf62695f98e9d0d25d72fd96c55105be504e485e0f300e9dbb4ac3643ce9d32390efbc2776ce95ef6a2d0ee9ca9b72ee616dd938f7741236faf8c1dcf3da884e065930052f10d8b6bd384f6428e07afeb2badd27cbe93b9f4d521c993d0895b8dd3223500897b4248966218e3b1cd0e01c3e2b1822352718974fe0d3a30de4788ace096e025c53f00f0b8905735e55667a9c5baa567b4b6701b61b97ee1a84b19624432d7555ad0187e149594ec00ea9b149b7784d9a8d45e29b2fa512fee6bb75c14bb65f85a07daaf9c219813503afb6d7e27e541df8168d6c2e6739ae9ed10eb4d053bc71451abddb3268995e994a95b441b59bb43fda3ad5a4ad0eaf568f746a55c1bbf6da3bf1e79732e1da81aecb523032cb62b4496120452dc4dabaab480e216580f47aaf4f9a14d9486c6e2090502f04347c40a3add1d3289f46b8f3406323ada0a367ddcf4a088c5a6f0d9de9156827781be582eea8e341b6271feef992188389966eadedf641818b0cfd36825555b0fb1197858eb75b97d2fa8aa28ad9122837547484d0d7e4effb394261b7d624345caaf4fd12868e919db5c7dd0c656e9fc3ce323d495380a3f2fc00020f15292d7490eaf0198d8f9ab9bae700000000000000000000000000000b10161e242c363d"
            })";

        EXPECT_THAT([&] { test::from_json<state::Transaction>(json::json::parse(input)); },
            ThrowsMessage<std::invalid_argument>("wrong transaction type"));
    }
    {
        constexpr std::string_view input = R"({
            "input": "",
            "gas": "0",
            "type": "1",
            "value": "0",
            "sender": "",
            "to": "",
            "maxFeePerGas": "0",
            "maxPriorityFeePerGas": "0",
            "nonce": "0",
            "publicKey": "0xb543b479d32596ff68142e1b094d6c5bb163637cdb1a7823545bbb247216c3eb88b3cc84994aecd8b2efca728e5b7d230aeab46f170fd728959fe12adaa224db67821612405e10f3ffd7ca17cbe6d334603df756982676098c4b312043c28e9ac4333c6adca787b626df488a6073e625ec15b43ad996540ff4acbc0399f86c3b71db66c34b418f88649a15998cdf66d2df70ec147b7806fa2af6e474a17fdf4fbfb9770fe667639cce85afe43af7921a25c47b4a90f681e2014444d2d1dd72e8425a3212dea2e32027c12d04f694fd760c3807296604d8e75bfc391227a07d8e94268bb05fdc6d60c2ec5295148fa440fa519199e8d71cef5d6273f41c6b97b45a78eea4b95ec1be66f68333a8aafb9a54afae1d2df212f0242a91fa3f7a56e41cceb5371e0e54e54e91e3a845ed4002b37d1b7fc9a38fa519403d5777ebeff4e670db5b5756d4528891bbd1633ea971e5abd94fd3952aa16a93ccac79ed0b7a3bfe61b9c8556540665d3f7671bab015a9558b30c16c664637e8f597f6f5f12438bddd3a6a8425c1d43e4f6284f06fc1fecd08e409d43e7f27bd7e80ced2d20a51de41e3d16c772b417a76e6a70bff7e7d77befa243a669ce8ff11c925f1f892cb77af590861983bfa5270dd0960cad197fb903b71cae817352bf9345cf6f1d764a66c5921f8fac3c85c03b32920ea152664d0a6cdc6ce1f972341bddcc6c5f42cee426c40957e2333cedff343f2be9a351b89cd7dc561eec8ae89f7e470d5248660c419dab6958bec40c7c660ec10ee2cd6b45f14e66bcc171d53b973191bed67d3a6dccd74658a483afb735a86a0c554aeb9ada238075c1804ac11930c268930d8bd9e43c2e2d961c0133a3e74661761b3020f772a2abdaa897679916c3b03c151224245e310d9be7f8d1720ab98edcfee9b9940e1524a3a31a17cf5a519ca0e798be339780484180d612286f74b6c050fd4b1afc7021fdf631acc8ba06fd203f149af1c3fe975b0a8118e23c888fc21a60b91acbc420cde6485291cc7d28a0cfcb24efd3458cef7a676dfa10f3d83decb681d48887d7bb49da95fa4f37eca3ffba930421924a20dcc5c3e18a4bac0ffa63d33d62bb2a35a42bab8daf98fab963d1973de9eca38a40e13afc860c06ab8f5e1d20204167871ceb7205530e76720613b009465bb96d6d0554d7f5cbb278fa43e27435a4900464527d42b5960554cc1de5c65cce01532e389fc8eef02f82310ae0965b005f408ce5869b12760660f3da490d9df0477f9afddc03385860014fb921e623ff675dfd9000ad648ccd07eaaeff6ad640c71ad1e23b4bebb16c4aad8a59c4601fc92b70e7269cc9526226c77ed430827efb0fc8ab78e6f16005a138635ad39d365571195a5429a8998a90309ce489186c2cb902ef7a6982bc4b2693abb911d75643877361189cb0d72c08b5eb8c820589cf4e5fe4d46c8721d6a021be1765b2d6c49718a87a03e675d108af6fd9b48f5abca6d7409b1fee92cb5145b9b76d669fce00f9ed6a1047f722b5b4ebfc80f3297ea615bd64ecf51b8777b3a67676d7c48e842bf80f7b84fe3932e58965aff87506739d8bce9792c86c78d43feb83c75008962cc9f4a2e9a52cb94745096cde33f60ad603646f29e317c0ff78c0a3ea200f665aa7c7a4faf338cead6a8ed91b87762cacfd49108ce5c1ec5719cec1cedfbfab64e2aaeb39eecdfae2a3a68df4ea4789c11d4f14fdb034c45c6edecb250cf61c84636ed220289ca958790acb106327705bef2f5cb4f5dd15ae03ed74ef55fffd24d2d8fdd8ef59d990ccf0a418afd23668108e926489145cd6a3e976094a6815962b0a8d45d4cee03ee53fd57e929248e1b6f077b16b6cd5e3e0e08f94bd87df1c360af983c995c126acc3ce00cb19d2dd673e0568dd014713c54d764b6f200a7efada394a44236b765d76261b07d69b76c6427a4433c4617b1503888d88c360636d8090b6dbd5cd2b8c9d83ed82180a150c663ea84d6cfcbad3d52a8b95854baaca3139c8ba52e4a2f6b5589ec77a6382eb502042687f4787b5daa8c6c48bc1d34dbb98a052e52b92a5d2fb5d3dfa0e590c187d93724d497cda403f574b70b1668e3ee2e86a6875135b4bec11a83d853ccebab523360de8cc0fef2594526a81643cef955d78846a7eb8db22b9b225c631d138c3d30cc95b8dea54385d6074a90db216ad07687b1d2353a9e657e61e09a5820cbc1aac4dc03725c60fd48f27b6f0f5420811b30e3bf3b194187cf65ace99d07f54e5b06b43554d63095ec6c3ba13bdcc115155614c7d27ba1940841435111d353251c90bc008e7138e0101b576a2bd60b5e14b4a9cfb51c06dc28681a6afd62c791309e618bfaebebdd59673cf0f5b5aa683816425c0bd1a36bf6f2e74e56db16d8bacd07c851ff6f83f59f38e7aad7479710327487bf176c097ba075191dc67fbdc058ef145a63a5e9f7bdf4904d82ccdb1948790ce99d0144aa12994dc4caee920a2dd5c2bb2c6159374f2ad102d640b7ee7fd94f87807b0eb17d5a676f30b6891aac832b3a541c803711b443dbee27c781471223e5a537312b2e789759bd914c0449d47e42f2690b50762ac4881344e55963a5c77234ef825889de8aadb45d8e9be4977f5868eda16a7744c4c7ade92c804157149005d2b6fb74f730d1695831b7a18c89e87bc2068eb943fa5612e6d130ada284c160d29d2a17ae60df3e8edda822f5c9cda318b51dd65d398d06e58a43ed2b8ff74aa9ab9aaf9c3e8765ba0a374dec4408baabe153a22971407de08ef7d10d20ae6318555f78af959d9a79e0ccf07f250e0f1ff0d900811f1f8fa695c8daace0bb2dbb44f4499e4be4afa47a0c3cdf89aca059a7b4851fd51713c50ba353b7ea9541057270c04c6b9adce2db02f2bade95f34c1b2e0045ac583b6526920031de3ab9bbea36e5ef91a8a012f62ee4803ccd168488d8490467838524f061d40416c4646f81e375937d90eb75d6ef7c36681023191487154e0c25374f8fd3a5d1891fe76c2201d29e6f6bcdd969bebc5512f84e52164fa1694dbce1bd034e5fcaef6ba96ec8945c49099d9dfc61f4d6f8b1ce22f0843ef649b09b67f670d029716855e4aa3f82651ddcce85b765a04eebe30cc8eebf85e69658d5dc19f705c27c989015ecf774b147059c8405c1bae15bd2c7b4a3a7bebed8729daa7f962a75708107e2445f975c3075eecb05439dc4b66b4cd8bf57392bf7be31682ae214049536971ddf7eb8e5b62d359b4c8097333b6ac423ca35dbcc52daedbcb9dc4d8e811e6c281794bfd676e78e675dca6ddfc1da8c05d54d990aea0e7050b75dc57473bc6ca0c6bd9d018a0f3d406816b89e90eb17951034da9f68dfb2736b0c42f4f98ad2301288436dd21c944485e8e084e0408e84e1946e67230730c6af3620f64475dd62fe614fd01a18952d8b396676f747107c467d37b12be91fe164ae083e5ce12f5e8c2a7bccea9f75ff8ea40cc2f8a4fa521fcd92adc7e5b1187ce7e233d7e98c8782b30ebd9ef9c2f15feb6373751accb6eba57b1ead3af4bc5a2b2b4acccaba442fbfbde89ac8ea1e5f9bbb5c122ce22a53371250a58e5d7a735419cc32a8ab047cf097253f8a84dfe64c208b0b0c80e5930cb26ce93f375eb3c1db4bb7",
            "signature": "0x131cea321925fbfd34681919d181826208ee5e27280a0882101b8072cf371aab14330a0fa303e2cbbc5ab5bd5f54e23077563a75f4f261e05ae6a7d55a92e8fe0b8c899d8b5145723c23e3d606f7797099866e0f4075dcd0f68c5a86295a4d1414acf5a14d22392477a96e12b4ac9f554f522381d9a641d888f1f4d0bb18092adbac3578c737233f9c39ff1ee7a23449d6b5f43e30dad56d3ac83a324fef6335faaab40ffaab92c1c9575d28645c2681031ca51141ee13d9dbf79fa0adbcb04b582fc6a41f6e9d13a1c5ebd89430c67e0cebd70905420be18465e6db742b117fb39b29613b7f29bb028535cfdc3e9fd2d498ce3c03947a1c28c1efcba723aad5599f6b9a1800cf47238ebf0c4ba4c0fc525302b16ada42d13511c4d231beca31ac680a8ee2ece5714705451160e3f8a9d2c2b8d1e18fdf2a9b38a0ef4bc1bb476fcce8a06e5d5f3f0f5f1e629b47670b093955fd2750ce3fd9b331b4f009d62fc07f86b18e6ecbdfc742f348836cd7abcdcf48f2c75960d01617007b4ac89ad220eefe9f933acfd1677513c042ba32e4d7bb1a4cd7d453b37e7a36770dac2f0e20a45ba8ca253d6bc87599e9b8c20879d6bbd30e116a219661cabe9e219abbbb6972bf9374817f4bc73528b0ae9831545571f3645dd9b210b5858570951cd32e3d81fe083073352d962d0c6ac212587fc99ad76a7dc15679e236f29cf33c38d7ae6ec364688f53f0a0d93875b6b8f969f5123579ca0311ff521a91f4e3010fc6863adc4c8056f41bd8441f38e6d197acf06ba452ddc2ed17156725a9db5db8aee34144af0f31bcdc8b15af8190351fa68656ff5f6cf0bf45345239fb0097cccca7536b81e08fede797118a5e10e1427f06e95e70a97b426bc2b1326eed13a07877958d2586d42552b41ecf1fcad21f59dc9c4d48837eb6fd0f9f20e3cda3f427f9d371abc99706596680c1bf068c238c361cb85f31c391662f9cbf6404144a07fae246da521d98fe21c039677f87f32357aa727ca8e5811f7a4af0c28eb800e734ec42332092133a77ad5a757f0f73ad8d0df0c07ecaa09dd78349b500c6bff466750107a1f8b9f3c8ff251b7026b1de0fa7a57806f447f5817f670aad99d89fe88e997f4f1c3f4a474bddfc424245a6042f923cad0d8b7a3ebdf005ac3138f7edfeab5b7d6a642f4b41d2e2b0b342bbdcb677d1440313fcd003e3cf6a18be70172f0f6ee0a5545a5dbd1902d0d9cadfb7e74cb4946364a81bf8d8440fb006b3ee0ccfead39209c4db55bcd339ce6b97d9016d30aa82118ba1a169daae06174c9f375fb02c6857925bd112c08307a463c46d94a74c6f61e8adc2eb3cc9fbdd6177ce0fce161aca2c23d424e1a3d8286f524bb73f5c4268dc3b10477758743780eedc9ef0aca5f24f1782dfb771713b8a04100681d8bbda636fcbb4cbb4eb38b84b9d038f5af5815dc0caa4085f0e75f06b4a23fcea2bc9673be28ff4f08f3b8f1da7d9a1b766e7858b7c9d07ac793395e240ec9479c9b6d1be8fdcfa034d596c21cca6a654ab8dbb86f4fa96cbb638ac79fcfb52f1758b2e25fa713e9d00cb1d049e05beb06a5fd7a41546c27f48e0d570361b3583ab0e3a8f45d66d26fb9ae45e1c2f5e21ecc6fdbe1a8887447407e6e846bdcc0c4503bdc4d1251413af44c4211ba2693f7739e608d4fae117298d5b54bdbe49d956854e652ac4fca43e754c5b9f7f6c07c8e591770fe5ec88250ec08a5c2aaed6ab0b547e7420522146a608488120da81f12a6812b6811224d8dcfddc3c2029cfc57f38d6c26b55006ae38332413a30981871123131dc9f59726abdb9ddcabb45cb681f2a9ec768dab64d0e91950b5a4402fb84600dfcea66ff9579a89b2310ab84940c7b4cafafe4b5401fb6b96d33595e3b2fc6d77caa4eb5acdc4e60ee2c825bdf9dd042ddb58ba228f0ffed3164fe5be4bf4c4c278b7d8002fba4a51ee116b16319da4e580bcf930bb354639554ec469066ac4b01d2fca1273c006bd65d9be494638e26e93871f6053cccdbc42450693d41d26baca77f2da4d7dc94f089fedb29da25968dab109a634d010dfe91bb04c7047151485412ff1a84cd7daa44c830b9767dac473b7d0f1da7e62c53c8c5ef41cdabb4b4a55cf0a37e6a8ca522d4f0ca6cec0ca4d154684a9123f4cf2573a013abf04aec343e79458b3510377a10d6a0b89a8f0abb52f1a77013357faa9e3ec2086c2dcc9299e06993590bcf3ee43d4f5a0a56830acb876af929ff56ae63120e7e33d040e4697ed3819d17878badcfef17ce5fad90c17e29448665ca0dcafcc891f696a50402eb9c96c517e5eb7e796b05db330d79e9e74ef8e14d22174607258ed4c704c11ac617b02cc4b628d7911acb7ab67def265a0cfc02a6b5e2b73922fc8be941d31cc192a113f70f803b6467cf0ce3b96c3cd6d652c6d11f98af06a12cd993b80daca08d16bd71b265218b62af36cf1ab5d975a13743f3acee638203cea0d1e54875b396d950036f3209620a487306589f9e4bf5ac88f3926fe93b8465ff50689f26a358d9461544a0c5484750333b75a2b8d471f962b1a7ae288372f06bfcc75b35721d551018b1604234f97a04d9dcc1dfee735857074ce8c2afed249add41226f0fa401bfd6d80b97d13648c62a50240a39bdcc0c5c653701bebee3fc0bee0650f4f27fb0701933b56766c4de3bce8750fd88fadf2bccb6c2e520422431474371e949091b36e89fddc0c63bcd95602f423e91eb7dcd4735ac41b47aa65b2ebdca4f7905c9282efd26ae7abaeccf329833b1135f8ad520c9ec36eb919e3793ee40ee6d393957aee78ed6afde608c43c985608c40a6e6ebc91c5b3ec7788ea17e30ba5752dbc22944e3a63615c42654f88f7f559b8dfc3addc60a94e3f22d023cdf9d67d3e0927e43f7151e335ed488716b34e22c67cb4ce5b2d8da9163d5ed5e582fcb05886ebd01f4f353bfe794bfa4b9f55ea79cc865f67a5d1a2536da33efba5fefcb368ae071ddd4ff58b201011e7a631d272adc15fab9ed46c5b8f5c0aad75f550327f738222713f9a752f754ee1bfa18b671c741d3ec6492a8525aea8428754b51b190cd4d290f8b1d470cf4b75ca541e8efe67ea38166c307958822a48e79c9cb7c83112009f47686d11bdc25bc3d1519e0e452967ccef3cf47669584088849de602afbec9c7d64951d6a4ad92a49d981b67d3a992bf83a9bb021408a2255186d9b7c229a51b505a5f8eb2603fd8822a2de8ca3c583bf9f373614ee905a6ebe2b478d0f07c1b790bc8c1e5db7f81511a12878dd97c242e9dffe8dfd087e17dfbe885132a4399136ee663f4d94a2e58dac1b8abfeaef38d7404802a72c2ddfc36591c27c5b369ef6174fa07e483a35d00101479e350e047f8adfc49e28862ea360dacaa9f52b8b0f5e2816bf80ad62906830f57d59357ffe7326e8f6e2185c026634e67346e801419473de2934f555b2061f9b9b459e71bd704c9156e0193fb12a6b8fd49719b21249ab8953ce04df037da1655c0ac0c3a25fec70c90fd18bf51946c18147f9e6a3287895f4d6183012701ded7de25ee3616b7237d910d42b065bc5e554b51d07f3e98c240e0a6c019c74075996ab23ad217daebd1f5c0bb402f597de5159235bc6589b76b94d7532b86b3d6728386ddffefbae921be8d05074011a75b63640829e68e2d4b70ecbac1637e4a9a77ee9ab8179d35ca0256b357a00dd63c792a1ad5ca259956a1b1a51f7819793b68443e2b28550e33a07d360b214581cbc367a87512d1dd758ce2e9f6196046412c942613b5ef4dce7c7fe07bbdf425eb0afab16192561bab9e67b06f47c461a9f5b3baae0f27ddf3a9812836e9debb961ebdb4cc377edfbc05a610ce8f7ce9f12e3c4abb6ca51b96323b204b48dfa8abeea27785c273a9d700c8f8fca96e1d1a2799fb23a045ffd58ca485bfc9d930ccee781beac3560f45909414806faf0bb8fc6657384c13fcd5e9da7b79834292dfd6418690b03cb6718b7c9637fa918f6a9a19d3dfe3a76d96bb3c0db0fd6751b9a394b55460042036e0b85c1e135a2a9d37dd871afa405e4ae5827c47e657d9694f51bee74768b03ee9e7b8731919e962cfaec19439e5eaa40f92e7094de8ab6c0a91b451b6d0cbefa9e44a471ca1549c78e66a2c622dc07294fa908e0e64e100c3550edb8c31f302f81aa8e154e9f666cfe904145a9c7ecdb3765f60c7ba06360df5639ef684653a5f90bb47510d0357cd5f0de0ed0419477b6af059f01948954b3844627853bb23fb76861fed81a09a03ce4a4c512dd91bba59e72aef3936290979d93222667ac31df7514e5eac1b53efdda607215af47a813af08588d28cd9c2ef93985b47bd6e833ac07de0af0aeeb92ad36af2c05f47d6a31ee75e19b841ffc79ae865edddd97865b7f661aed157922f93903884cc6d489d8f1a6160c31509b9250c481c9d9ed99778e90a38969549c563820a13ebb5dd0184dfc58d28614ce1522bf4e99724e9452f64592ab01424035581780653d5093468c555dfc52ac86e43644e0f3f89d06c7cc0d6566bde0b2fdb896665425e5cc80bd4795247217a08f16fdf9e522ff7868b01598e0b8a41da2221fdb646409eb102107a20d5ea06ea3b3c0139d02480be6e42cc00b2a32ccdd0eeeaea90e1dcbef4bbd7b7100a74486354ce5baa8a230ec7c58e1f9269124057c491c48a02159cf3f37375f8bfaeb4eafd6fa9d8209dbcba61c8d189171c313ac75ed7d69f5b16ee60ee7cfc0f98d76796643d2bf4555db2b3604914e06b2c55dc62607bf622956705762005ceeed11599871f89cc7e2d4d86231bec5d423382e77f9707c41d6062efc56512e6339e34b64152393e8d42391b6311423f8730a85261375e5fcd5cff5f26abb6faaa75e8f8167cc6374f8f3fbe10b688f292fb4cc12c93f678b8f5110cd8baaae7e8ba05a11f8b469adb853f7d20fe2d6b8f0980e83ec83ae042ea10a3cf6a5dafe4015ed86e0a484350dc433f7870f8b3069dcbeeefb4c00b9abfbfe0a97419fee479985525b018c71d686ea99adf70afabe29d392e5fab7535aaaa05cf362e9797d5f4269b16e7c9e9a6b45c48a29de93a5c44e00efc4bae4c730e77810d00db122b86ea9997d9a7a0b1b677c589e9c6a97c8b548aedc65be6eed71e5f6e603aee2dca7fe352a0ee7c041c597131b9e46d867e48e0a3c81628f082bea4868c487e8056734a2a2396e6ee7e730e3dafdd3ee268c422ce667f5ca4e9da3093eb1d3fc8d504691a1a0c5c7b12471ccb63a64222cee4e4e1f212a44ea1446c0dc03696003c7a62a8e4ad0627d7f55c638c775180c4cbf9ed92ac46dd54210a0212e0f88a7cdd5a87c12199fe0bd04f6524fb0a986c96144ebcc6763dfa6e2cf962600a88c010f9a2798849e8e87651cc26d23624bcdca0be537eba155c61dee81dd13a49b7a657527684fa9bb5f8850311cd4c2fceed60b25fab1439a7b5da79af49b410da8329d16fea6d653116432e9cc09ea6d25fe860d30594715512af8f0e160989e17109951d299016c54a3434ee9f9f1f4123155e2c6670b3472acbee2c20c125f26032587857576e4071dea5d5ed935407b599eb9ecc1dc044356862210109d7e875cc0e4febf92fa18d688b4c62b3fda45953b9cd8f78b95573fb94707c30822179ef41d70056ee8f4f67c81a94064c43aaab8b737b6cdc14045ae5ab3280c9a5a6669c43c59956fec9fdbf7c677b6a52e7bde7273f20d778d3cef557a624cb953951b6085384cbc2e0bf93e26779011ee3d7e1b687da115aeae8f0112bf470c0a04c62dbae988d460bf62695f98e9d0d25d72fd96c55105be504e485e0f300e9dbb4ac3643ce9d32390efbc2776ce95ef6a2d0ee9ca9b72ee616dd938f7741236faf8c1dcf3da884e065930052f10d8b6bd384f6428e07afeb2badd27cbe93b9f4d521c993d0895b8dd3223500897b4248966218e3b1cd0e01c3e2b1822352718974fe0d3a30de4788ace096e025c53f00f0b8905735e55667a9c5baa567b4b6701b61b97ee1a84b19624432d7555ad0187e149594ec00ea9b149b7784d9a8d45e29b2fa512fee6bb75c14bb65f85a07daaf9c219813503afb6d7e27e541df8168d6c2e6739ae9ed10eb4d053bc71451abddb3268995e994a95b441b59bb43fda3ad5a4ad0eaf568f746a55c1bbf6da3bf1e79732e1da81aecb523032cb62b4496120452dc4dabaab480e216580f47aaf4f9a14d9486c6e2090502f04347c40a3add1d3289f46b8f3406323ada0a367ddcf4a088c5a6f0d9de9156827781be582eea8e341b6271feef992188389966eadedf641818b0cfd36825555b0fb1197858eb75b97d2fa8aa28ad9122837547484d0d7e4effb394261b7d624345caaf4fd12868e919db5c7dd0c656e9fc3ce323d495380a3f2fc00020f15292d7490eaf0198d8f9ab9bae700000000000000000000000000000b10161e242c363d"
        })";

        EXPECT_THAT([&] { test::from_json<state::Transaction>(json::json::parse(input)); },
            ThrowsMessage<std::invalid_argument>("wrong transaction type"));
    }

    {
        constexpr std::string_view input = R"({
            "input": "",
            "gas": "0",
            "type": "1",
            "value": "0",
            "sender": "",
            "to": "",
            "maxFeePerGas": "0",
            "maxPriorityFeePerGas": "0",
            "accessList": [
                {"address": "ac01", "storageKeys": []},
                {"address": "ac02", "storageKeys": ["fe", "00"]}
            ],
            "nonce": "0",
            "publicKey": "0xb543b479d32596ff68142e1b094d6c5bb163637cdb1a7823545bbb247216c3eb88b3cc84994aecd8b2efca728e5b7d230aeab46f170fd728959fe12adaa224db67821612405e10f3ffd7ca17cbe6d334603df756982676098c4b312043c28e9ac4333c6adca787b626df488a6073e625ec15b43ad996540ff4acbc0399f86c3b71db66c34b418f88649a15998cdf66d2df70ec147b7806fa2af6e474a17fdf4fbfb9770fe667639cce85afe43af7921a25c47b4a90f681e2014444d2d1dd72e8425a3212dea2e32027c12d04f694fd760c3807296604d8e75bfc391227a07d8e94268bb05fdc6d60c2ec5295148fa440fa519199e8d71cef5d6273f41c6b97b45a78eea4b95ec1be66f68333a8aafb9a54afae1d2df212f0242a91fa3f7a56e41cceb5371e0e54e54e91e3a845ed4002b37d1b7fc9a38fa519403d5777ebeff4e670db5b5756d4528891bbd1633ea971e5abd94fd3952aa16a93ccac79ed0b7a3bfe61b9c8556540665d3f7671bab015a9558b30c16c664637e8f597f6f5f12438bddd3a6a8425c1d43e4f6284f06fc1fecd08e409d43e7f27bd7e80ced2d20a51de41e3d16c772b417a76e6a70bff7e7d77befa243a669ce8ff11c925f1f892cb77af590861983bfa5270dd0960cad197fb903b71cae817352bf9345cf6f1d764a66c5921f8fac3c85c03b32920ea152664d0a6cdc6ce1f972341bddcc6c5f42cee426c40957e2333cedff343f2be9a351b89cd7dc561eec8ae89f7e470d5248660c419dab6958bec40c7c660ec10ee2cd6b45f14e66bcc171d53b973191bed67d3a6dccd74658a483afb735a86a0c554aeb9ada238075c1804ac11930c268930d8bd9e43c2e2d961c0133a3e74661761b3020f772a2abdaa897679916c3b03c151224245e310d9be7f8d1720ab98edcfee9b9940e1524a3a31a17cf5a519ca0e798be339780484180d612286f74b6c050fd4b1afc7021fdf631acc8ba06fd203f149af1c3fe975b0a8118e23c888fc21a60b91acbc420cde6485291cc7d28a0cfcb24efd3458cef7a676dfa10f3d83decb681d48887d7bb49da95fa4f37eca3ffba930421924a20dcc5c3e18a4bac0ffa63d33d62bb2a35a42bab8daf98fab963d1973de9eca38a40e13afc860c06ab8f5e1d20204167871ceb7205530e76720613b009465bb96d6d0554d7f5cbb278fa43e27435a4900464527d42b5960554cc1de5c65cce01532e389fc8eef02f82310ae0965b005f408ce5869b12760660f3da490d9df0477f9afddc03385860014fb921e623ff675dfd9000ad648ccd07eaaeff6ad640c71ad1e23b4bebb16c4aad8a59c4601fc92b70e7269cc9526226c77ed430827efb0fc8ab78e6f16005a138635ad39d365571195a5429a8998a90309ce489186c2cb902ef7a6982bc4b2693abb911d75643877361189cb0d72c08b5eb8c820589cf4e5fe4d46c8721d6a021be1765b2d6c49718a87a03e675d108af6fd9b48f5abca6d7409b1fee92cb5145b9b76d669fce00f9ed6a1047f722b5b4ebfc80f3297ea615bd64ecf51b8777b3a67676d7c48e842bf80f7b84fe3932e58965aff87506739d8bce9792c86c78d43feb83c75008962cc9f4a2e9a52cb94745096cde33f60ad603646f29e317c0ff78c0a3ea200f665aa7c7a4faf338cead6a8ed91b87762cacfd49108ce5c1ec5719cec1cedfbfab64e2aaeb39eecdfae2a3a68df4ea4789c11d4f14fdb034c45c6edecb250cf61c84636ed220289ca958790acb106327705bef2f5cb4f5dd15ae03ed74ef55fffd24d2d8fdd8ef59d990ccf0a418afd23668108e926489145cd6a3e976094a6815962b0a8d45d4cee03ee53fd57e929248e1b6f077b16b6cd5e3e0e08f94bd87df1c360af983c995c126acc3ce00cb19d2dd673e0568dd014713c54d764b6f200a7efada394a44236b765d76261b07d69b76c6427a4433c4617b1503888d88c360636d8090b6dbd5cd2b8c9d83ed82180a150c663ea84d6cfcbad3d52a8b95854baaca3139c8ba52e4a2f6b5589ec77a6382eb502042687f4787b5daa8c6c48bc1d34dbb98a052e52b92a5d2fb5d3dfa0e590c187d93724d497cda403f574b70b1668e3ee2e86a6875135b4bec11a83d853ccebab523360de8cc0fef2594526a81643cef955d78846a7eb8db22b9b225c631d138c3d30cc95b8dea54385d6074a90db216ad07687b1d2353a9e657e61e09a5820cbc1aac4dc03725c60fd48f27b6f0f5420811b30e3bf3b194187cf65ace99d07f54e5b06b43554d63095ec6c3ba13bdcc115155614c7d27ba1940841435111d353251c90bc008e7138e0101b576a2bd60b5e14b4a9cfb51c06dc28681a6afd62c791309e618bfaebebdd59673cf0f5b5aa683816425c0bd1a36bf6f2e74e56db16d8bacd07c851ff6f83f59f38e7aad7479710327487bf176c097ba075191dc67fbdc058ef145a63a5e9f7bdf4904d82ccdb1948790ce99d0144aa12994dc4caee920a2dd5c2bb2c6159374f2ad102d640b7ee7fd94f87807b0eb17d5a676f30b6891aac832b3a541c803711b443dbee27c781471223e5a537312b2e789759bd914c0449d47e42f2690b50762ac4881344e55963a5c77234ef825889de8aadb45d8e9be4977f5868eda16a7744c4c7ade92c804157149005d2b6fb74f730d1695831b7a18c89e87bc2068eb943fa5612e6d130ada284c160d29d2a17ae60df3e8edda822f5c9cda318b51dd65d398d06e58a43ed2b8ff74aa9ab9aaf9c3e8765ba0a374dec4408baabe153a22971407de08ef7d10d20ae6318555f78af959d9a79e0ccf07f250e0f1ff0d900811f1f8fa695c8daace0bb2dbb44f4499e4be4afa47a0c3cdf89aca059a7b4851fd51713c50ba353b7ea9541057270c04c6b9adce2db02f2bade95f34c1b2e0045ac583b6526920031de3ab9bbea36e5ef91a8a012f62ee4803ccd168488d8490467838524f061d40416c4646f81e375937d90eb75d6ef7c36681023191487154e0c25374f8fd3a5d1891fe76c2201d29e6f6bcdd969bebc5512f84e52164fa1694dbce1bd034e5fcaef6ba96ec8945c49099d9dfc61f4d6f8b1ce22f0843ef649b09b67f670d029716855e4aa3f82651ddcce85b765a04eebe30cc8eebf85e69658d5dc19f705c27c989015ecf774b147059c8405c1bae15bd2c7b4a3a7bebed8729daa7f962a75708107e2445f975c3075eecb05439dc4b66b4cd8bf57392bf7be31682ae214049536971ddf7eb8e5b62d359b4c8097333b6ac423ca35dbcc52daedbcb9dc4d8e811e6c281794bfd676e78e675dca6ddfc1da8c05d54d990aea0e7050b75dc57473bc6ca0c6bd9d018a0f3d406816b89e90eb17951034da9f68dfb2736b0c42f4f98ad2301288436dd21c944485e8e084e0408e84e1946e67230730c6af3620f64475dd62fe614fd01a18952d8b396676f747107c467d37b12be91fe164ae083e5ce12f5e8c2a7bccea9f75ff8ea40cc2f8a4fa521fcd92adc7e5b1187ce7e233d7e98c8782b30ebd9ef9c2f15feb6373751accb6eba57b1ead3af4bc5a2b2b4acccaba442fbfbde89ac8ea1e5f9bbb5c122ce22a53371250a58e5d7a735419cc32a8ab047cf097253f8a84dfe64c208b0b0c80e5930cb26ce93f375eb3c1db4bb7",
            "signature": "0x131cea321925fbfd34681919d181826208ee5e27280a0882101b8072cf371aab14330a0fa303e2cbbc5ab5bd5f54e23077563a75f4f261e05ae6a7d55a92e8fe0b8c899d8b5145723c23e3d606f7797099866e0f4075dcd0f68c5a86295a4d1414acf5a14d22392477a96e12b4ac9f554f522381d9a641d888f1f4d0bb18092adbac3578c737233f9c39ff1ee7a23449d6b5f43e30dad56d3ac83a324fef6335faaab40ffaab92c1c9575d28645c2681031ca51141ee13d9dbf79fa0adbcb04b582fc6a41f6e9d13a1c5ebd89430c67e0cebd70905420be18465e6db742b117fb39b29613b7f29bb028535cfdc3e9fd2d498ce3c03947a1c28c1efcba723aad5599f6b9a1800cf47238ebf0c4ba4c0fc525302b16ada42d13511c4d231beca31ac680a8ee2ece5714705451160e3f8a9d2c2b8d1e18fdf2a9b38a0ef4bc1bb476fcce8a06e5d5f3f0f5f1e629b47670b093955fd2750ce3fd9b331b4f009d62fc07f86b18e6ecbdfc742f348836cd7abcdcf48f2c75960d01617007b4ac89ad220eefe9f933acfd1677513c042ba32e4d7bb1a4cd7d453b37e7a36770dac2f0e20a45ba8ca253d6bc87599e9b8c20879d6bbd30e116a219661cabe9e219abbbb6972bf9374817f4bc73528b0ae9831545571f3645dd9b210b5858570951cd32e3d81fe083073352d962d0c6ac212587fc99ad76a7dc15679e236f29cf33c38d7ae6ec364688f53f0a0d93875b6b8f969f5123579ca0311ff521a91f4e3010fc6863adc4c8056f41bd8441f38e6d197acf06ba452ddc2ed17156725a9db5db8aee34144af0f31bcdc8b15af8190351fa68656ff5f6cf0bf45345239fb0097cccca7536b81e08fede797118a5e10e1427f06e95e70a97b426bc2b1326eed13a07877958d2586d42552b41ecf1fcad21f59dc9c4d48837eb6fd0f9f20e3cda3f427f9d371abc99706596680c1bf068c238c361cb85f31c391662f9cbf6404144a07fae246da521d98fe21c039677f87f32357aa727ca8e5811f7a4af0c28eb800e734ec42332092133a77ad5a757f0f73ad8d0df0c07ecaa09dd78349b500c6bff466750107a1f8b9f3c8ff251b7026b1de0fa7a57806f447f5817f670aad99d89fe88e997f4f1c3f4a474bddfc424245a6042f923cad0d8b7a3ebdf005ac3138f7edfeab5b7d6a642f4b41d2e2b0b342bbdcb677d1440313fcd003e3cf6a18be70172f0f6ee0a5545a5dbd1902d0d9cadfb7e74cb4946364a81bf8d8440fb006b3ee0ccfead39209c4db55bcd339ce6b97d9016d30aa82118ba1a169daae06174c9f375fb02c6857925bd112c08307a463c46d94a74c6f61e8adc2eb3cc9fbdd6177ce0fce161aca2c23d424e1a3d8286f524bb73f5c4268dc3b10477758743780eedc9ef0aca5f24f1782dfb771713b8a04100681d8bbda636fcbb4cbb4eb38b84b9d038f5af5815dc0caa4085f0e75f06b4a23fcea2bc9673be28ff4f08f3b8f1da7d9a1b766e7858b7c9d07ac793395e240ec9479c9b6d1be8fdcfa034d596c21cca6a654ab8dbb86f4fa96cbb638ac79fcfb52f1758b2e25fa713e9d00cb1d049e05beb06a5fd7a41546c27f48e0d570361b3583ab0e3a8f45d66d26fb9ae45e1c2f5e21ecc6fdbe1a8887447407e6e846bdcc0c4503bdc4d1251413af44c4211ba2693f7739e608d4fae117298d5b54bdbe49d956854e652ac4fca43e754c5b9f7f6c07c8e591770fe5ec88250ec08a5c2aaed6ab0b547e7420522146a608488120da81f12a6812b6811224d8dcfddc3c2029cfc57f38d6c26b55006ae38332413a30981871123131dc9f59726abdb9ddcabb45cb681f2a9ec768dab64d0e91950b5a4402fb84600dfcea66ff9579a89b2310ab84940c7b4cafafe4b5401fb6b96d33595e3b2fc6d77caa4eb5acdc4e60ee2c825bdf9dd042ddb58ba228f0ffed3164fe5be4bf4c4c278b7d8002fba4a51ee116b16319da4e580bcf930bb354639554ec469066ac4b01d2fca1273c006bd65d9be494638e26e93871f6053cccdbc42450693d41d26baca77f2da4d7dc94f089fedb29da25968dab109a634d010dfe91bb04c7047151485412ff1a84cd7daa44c830b9767dac473b7d0f1da7e62c53c8c5ef41cdabb4b4a55cf0a37e6a8ca522d4f0ca6cec0ca4d154684a9123f4cf2573a013abf04aec343e79458b3510377a10d6a0b89a8f0abb52f1a77013357faa9e3ec2086c2dcc9299e06993590bcf3ee43d4f5a0a56830acb876af929ff56ae63120e7e33d040e4697ed3819d17878badcfef17ce5fad90c17e29448665ca0dcafcc891f696a50402eb9c96c517e5eb7e796b05db330d79e9e74ef8e14d22174607258ed4c704c11ac617b02cc4b628d7911acb7ab67def265a0cfc02a6b5e2b73922fc8be941d31cc192a113f70f803b6467cf0ce3b96c3cd6d652c6d11f98af06a12cd993b80daca08d16bd71b265218b62af36cf1ab5d975a13743f3acee638203cea0d1e54875b396d950036f3209620a487306589f9e4bf5ac88f3926fe93b8465ff50689f26a358d9461544a0c5484750333b75a2b8d471f962b1a7ae288372f06bfcc75b35721d551018b1604234f97a04d9dcc1dfee735857074ce8c2afed249add41226f0fa401bfd6d80b97d13648c62a50240a39bdcc0c5c653701bebee3fc0bee0650f4f27fb0701933b56766c4de3bce8750fd88fadf2bccb6c2e520422431474371e949091b36e89fddc0c63bcd95602f423e91eb7dcd4735ac41b47aa65b2ebdca4f7905c9282efd26ae7abaeccf329833b1135f8ad520c9ec36eb919e3793ee40ee6d393957aee78ed6afde608c43c985608c40a6e6ebc91c5b3ec7788ea17e30ba5752dbc22944e3a63615c42654f88f7f559b8dfc3addc60a94e3f22d023cdf9d67d3e0927e43f7151e335ed488716b34e22c67cb4ce5b2d8da9163d5ed5e582fcb05886ebd01f4f353bfe794bfa4b9f55ea79cc865f67a5d1a2536da33efba5fefcb368ae071ddd4ff58b201011e7a631d272adc15fab9ed46c5b8f5c0aad75f550327f738222713f9a752f754ee1bfa18b671c741d3ec6492a8525aea8428754b51b190cd4d290f8b1d470cf4b75ca541e8efe67ea38166c307958822a48e79c9cb7c83112009f47686d11bdc25bc3d1519e0e452967ccef3cf47669584088849de602afbec9c7d64951d6a4ad92a49d981b67d3a992bf83a9bb021408a2255186d9b7c229a51b505a5f8eb2603fd8822a2de8ca3c583bf9f373614ee905a6ebe2b478d0f07c1b790bc8c1e5db7f81511a12878dd97c242e9dffe8dfd087e17dfbe885132a4399136ee663f4d94a2e58dac1b8abfeaef38d7404802a72c2ddfc36591c27c5b369ef6174fa07e483a35d00101479e350e047f8adfc49e28862ea360dacaa9f52b8b0f5e2816bf80ad62906830f57d59357ffe7326e8f6e2185c026634e67346e801419473de2934f555b2061f9b9b459e71bd704c9156e0193fb12a6b8fd49719b21249ab8953ce04df037da1655c0ac0c3a25fec70c90fd18bf51946c18147f9e6a3287895f4d6183012701ded7de25ee3616b7237d910d42b065bc5e554b51d07f3e98c240e0a6c019c74075996ab23ad217daebd1f5c0bb402f597de5159235bc6589b76b94d7532b86b3d6728386ddffefbae921be8d05074011a75b63640829e68e2d4b70ecbac1637e4a9a77ee9ab8179d35ca0256b357a00dd63c792a1ad5ca259956a1b1a51f7819793b68443e2b28550e33a07d360b214581cbc367a87512d1dd758ce2e9f6196046412c942613b5ef4dce7c7fe07bbdf425eb0afab16192561bab9e67b06f47c461a9f5b3baae0f27ddf3a9812836e9debb961ebdb4cc377edfbc05a610ce8f7ce9f12e3c4abb6ca51b96323b204b48dfa8abeea27785c273a9d700c8f8fca96e1d1a2799fb23a045ffd58ca485bfc9d930ccee781beac3560f45909414806faf0bb8fc6657384c13fcd5e9da7b79834292dfd6418690b03cb6718b7c9637fa918f6a9a19d3dfe3a76d96bb3c0db0fd6751b9a394b55460042036e0b85c1e135a2a9d37dd871afa405e4ae5827c47e657d9694f51bee74768b03ee9e7b8731919e962cfaec19439e5eaa40f92e7094de8ab6c0a91b451b6d0cbefa9e44a471ca1549c78e66a2c622dc07294fa908e0e64e100c3550edb8c31f302f81aa8e154e9f666cfe904145a9c7ecdb3765f60c7ba06360df5639ef684653a5f90bb47510d0357cd5f0de0ed0419477b6af059f01948954b3844627853bb23fb76861fed81a09a03ce4a4c512dd91bba59e72aef3936290979d93222667ac31df7514e5eac1b53efdda607215af47a813af08588d28cd9c2ef93985b47bd6e833ac07de0af0aeeb92ad36af2c05f47d6a31ee75e19b841ffc79ae865edddd97865b7f661aed157922f93903884cc6d489d8f1a6160c31509b9250c481c9d9ed99778e90a38969549c563820a13ebb5dd0184dfc58d28614ce1522bf4e99724e9452f64592ab01424035581780653d5093468c555dfc52ac86e43644e0f3f89d06c7cc0d6566bde0b2fdb896665425e5cc80bd4795247217a08f16fdf9e522ff7868b01598e0b8a41da2221fdb646409eb102107a20d5ea06ea3b3c0139d02480be6e42cc00b2a32ccdd0eeeaea90e1dcbef4bbd7b7100a74486354ce5baa8a230ec7c58e1f9269124057c491c48a02159cf3f37375f8bfaeb4eafd6fa9d8209dbcba61c8d189171c313ac75ed7d69f5b16ee60ee7cfc0f98d76796643d2bf4555db2b3604914e06b2c55dc62607bf622956705762005ceeed11599871f89cc7e2d4d86231bec5d423382e77f9707c41d6062efc56512e6339e34b64152393e8d42391b6311423f8730a85261375e5fcd5cff5f26abb6faaa75e8f8167cc6374f8f3fbe10b688f292fb4cc12c93f678b8f5110cd8baaae7e8ba05a11f8b469adb853f7d20fe2d6b8f0980e83ec83ae042ea10a3cf6a5dafe4015ed86e0a484350dc433f7870f8b3069dcbeeefb4c00b9abfbfe0a97419fee479985525b018c71d686ea99adf70afabe29d392e5fab7535aaaa05cf362e9797d5f4269b16e7c9e9a6b45c48a29de93a5c44e00efc4bae4c730e77810d00db122b86ea9997d9a7a0b1b677c589e9c6a97c8b548aedc65be6eed71e5f6e603aee2dca7fe352a0ee7c041c597131b9e46d867e48e0a3c81628f082bea4868c487e8056734a2a2396e6ee7e730e3dafdd3ee268c422ce667f5ca4e9da3093eb1d3fc8d504691a1a0c5c7b12471ccb63a64222cee4e4e1f212a44ea1446c0dc03696003c7a62a8e4ad0627d7f55c638c775180c4cbf9ed92ac46dd54210a0212e0f88a7cdd5a87c12199fe0bd04f6524fb0a986c96144ebcc6763dfa6e2cf962600a88c010f9a2798849e8e87651cc26d23624bcdca0be537eba155c61dee81dd13a49b7a657527684fa9bb5f8850311cd4c2fceed60b25fab1439a7b5da79af49b410da8329d16fea6d653116432e9cc09ea6d25fe860d30594715512af8f0e160989e17109951d299016c54a3434ee9f9f1f4123155e2c6670b3472acbee2c20c125f26032587857576e4071dea5d5ed935407b599eb9ecc1dc044356862210109d7e875cc0e4febf92fa18d688b4c62b3fda45953b9cd8f78b95573fb94707c30822179ef41d70056ee8f4f67c81a94064c43aaab8b737b6cdc14045ae5ab3280c9a5a6669c43c59956fec9fdbf7c677b6a52e7bde7273f20d778d3cef557a624cb953951b6085384cbc2e0bf93e26779011ee3d7e1b687da115aeae8f0112bf470c0a04c62dbae988d460bf62695f98e9d0d25d72fd96c55105be504e485e0f300e9dbb4ac3643ce9d32390efbc2776ce95ef6a2d0ee9ca9b72ee616dd938f7741236faf8c1dcf3da884e065930052f10d8b6bd384f6428e07afeb2badd27cbe93b9f4d521c993d0895b8dd3223500897b4248966218e3b1cd0e01c3e2b1822352718974fe0d3a30de4788ace096e025c53f00f0b8905735e55667a9c5baa567b4b6701b61b97ee1a84b19624432d7555ad0187e149594ec00ea9b149b7784d9a8d45e29b2fa512fee6bb75c14bb65f85a07daaf9c219813503afb6d7e27e541df8168d6c2e6739ae9ed10eb4d053bc71451abddb3268995e994a95b441b59bb43fda3ad5a4ad0eaf568f746a55c1bbf6da3bf1e79732e1da81aecb523032cb62b4496120452dc4dabaab480e216580f47aaf4f9a14d9486c6e2090502f04347c40a3add1d3289f46b8f3406323ada0a367ddcf4a088c5a6f0d9de9156827781be582eea8e341b6271feef992188389966eadedf641818b0cfd36825555b0fb1197858eb75b97d2fa8aa28ad9122837547484d0d7e4effb394261b7d624345caaf4fd12868e919db5c7dd0c656e9fc3ce323d495380a3f2fc00020f15292d7490eaf0198d8f9ab9bae700000000000000000000000000000b10161e242c363d"
        })";

        EXPECT_THAT([&] { test::from_json<state::Transaction>(json::json::parse(input)); },
            ThrowsMessage<std::invalid_argument>("wrong transaction type"));
    }
}

namespace evmone::test
{
// This function is used only by the following test case and in `statetest_loader.cpp` where it is
// defined.
template <>
uint8_t from_json<uint8_t>(const json::json& j);
}  // namespace evmone::test

TEST(statetest_loader, load_uint8_t)
{
    {
        constexpr std::string_view input = R"({
            "v": "0xFF"
        })";

        EXPECT_EQ(test::from_json<uint8_t>(json::json::parse(input)["v"]), 255);
    }
    {
        constexpr std::string_view input = R"({
            "v": "0x100"
        })";

        EXPECT_THROW(test::from_json<uint8_t>(json::json::parse(input)["v"]), std::out_of_range);
    }
}
